<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Snow Modeling - Snow Cookbook</title><meta property="og:title" content="Snow Modeling - Snow Cookbook"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png"/><meta property="og:image" content="/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png"/><link rel="stylesheet" href="/snow-cookbook/_preview/28/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/snow-cookbook/_preview/28/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-T52X8HNYE8"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-T52X8HNYE8');</script><link rel="icon" href="/snow-cookbook/_preview/28/favicon.ico"/><link rel="stylesheet" href="/snow-cookbook/_preview/28/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://projectpythia.org"><div class="p-1 mr-3"><img src="/snow-cookbook/_preview/28/build/config-item-24692dda-fb588f958fcb4ad5b7e368bf0fa823d9.svg" class="h-9 dark:hidden" height="2.25rem"/><img src="/snow-cookbook/_preview/28/build/config-item-84d6d338-7eb6fc113a7f04273c7e9e629fc08d74.svg" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/snow-cookbook/_preview/28https://projectpythia.org">Home</a></div><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/snow-cookbook/_preview/28https://foundations.projectpythia.org">Foundations</a></div><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/snow-cookbook/_preview/28https://cookbooks.projectpythia.org/">Cookbooks</a></div><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/snow-cookbook/_preview/28https://projectpythia.org/resource-gallery/">Resources</a></div><div class="relative inline-block mx-2 grow-0"><a class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75" href="/snow-cookbook/_preview/28https://projectpythia.org/#join-us">Community</a></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Project Pythia</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Home</a><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Foundations</a><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Cookbooks</a><a href="https://projectpythia.org/resource-gallery/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Resources</a><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Community</a></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Snow Cookbook" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/snow-cookbook/_preview/28/">Snow Cookbook</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preamble" class="block break-words rounded py-2 grow cursor-pointer">Preamble</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Data Access" class="block break-words rounded py-2 grow cursor-pointer">Data Access</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rup8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rup8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Observations" class="block break-words rounded py-2 grow cursor-pointer">Observations</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16p8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16p8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Analysis and Machine Learning" class="block break-words rounded py-2 grow cursor-pointer">Analysis and Machine Learning</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1ep8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1ep8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="opacity-50 hover:opacity-100 text-inherit hover:text-inherit" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Code License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/SnowEx/snow-cookbook" title="GitHub Repository: SnowEx/snow-cookbook" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/SnowEx/snow-cookbook/edit/HEAD/notebooks/snowmodeling_tutorial_pt1.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">Snow Modeling</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">The SnowPit Community</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="x5HOUAlj3h" class="relative group/block"><p><strong>Contributors:</strong> <em>Melissa Wrzesien<sup>1,2</sup>, Brendan McAndrew<sup>1,3</sup>, Jian Li<sup>4,5</sup>, Caleb Spradlin<sup>4,6</sup></em></p><p><em><sup>1</sup> Hydrological Sciences Lab, NASA Goddard Space Flight Center, <sup>2</sup> University of Maryland, <sup>3</sup> Science Systems and Applications, Inc., <sup>4</sup> InuTeq, LLC, <sup>5</sup> Computational and Information Sciences and Technology Office (CISTO), NASA Goddard Space Flight Center, <sup>6</sup> High Performance Computing, NASA Goddard Space Flight Center</em></p></div><div id="FsbQzSzKxt" class="relative group/block"><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Learning Objectives</div></div><div class="myst-admonition-body px-4 py-1"><ul><li><p>Learn about the role of modeling in a satellite mission</p></li><li><p>Open, explore, and visualize gridded model output</p></li><li><p>Compare model output to raster- and point-based observation datasets</p></li></ul></div></aside></div><div id="uzDLrnP2vj" class="relative group/block"><p>The goal of a future snow satellite is to provide improved understanding of global snow mass, as compared to current estimates. However, <em>a single sensor likely won’t be able to accurately observe all types of snow in all conditions for the entire globe</em>. Instead, we need to combine future snow observations with other tools - including models and observations from currently available satellites.</p><p>Models can also help to extend snow observations to areas where observations are not available. Data may be missing due to orbit gaps or masked out in regions of higher uncertainty. Remote sensing observations and models can be combined through <strong>data assimilation</strong>, a process where observations are used to constrain model estimates.</p><img id="WuVBQd0Hs9" style="margin:0 auto" src="/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png" data-canonical-url="./images/modeling/DAflowchart_v4.png" class=""/><p>The figure above shows a conceptual example of how satellite observations with orbit gaps could be combined with a model to produce results with no missing data. (Figure modified from diagram provided by Eunsang Cho)</p></div><div id="dOWElXnlbs" class="relative group/block"><h3 id="what-is-lis" class="relative group"><span class="heading-text">What is LIS?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#what-is-lis" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Since models will likely play a role in processing observations from a snow satellite mission, it is important to become comfortable working with gridded data products. Today we will use sample model output from <strong>NASA’s Land Information System (LIS)</strong>.</p><blockquote><p>The Land Information System is a software framework for land surface modeling and data assimilation developed with the goal of integrating satellite and ground-based observational data products with advanced modeling techniques to produce estimates of land surface states and fluxes.</p></blockquote><p><strong>TL;DR</strong> LIS = land surface models + data assimilation</p><img id="nCXMsIiQDK" style="margin:0 auto" src="/snow-cookbook/_preview/28/build/LIS_schematic-58f4b7dbdf1980fef5db8ae60a513e5c.png" data-canonical-url="./images/modeling/LIS_schematic.png" class=""/><p>One key feature LIS provides is flexibility to meet user needs. LIS consists of a collection of plug-ins, or modules, that allow users to design simulations with their choice of land surface model, meteorological forcing, data assimilation, hydrological routing, land surface parameters, and more. The plug-in based design also provides extensibility, making it easier to add new functionality to the LIS framework.</p><p>Current efforts to expand support for snow modeling include implementation of snow modules, such as <cite class="" data-state="closed"><a href="https://doi.org/10.1175/jhm548.1" target="_blank" rel="noreferrer" class="hover-link">SnowModel</a></cite> and <a target="_blank" rel="noreferrer" href="http://www.umr-cnrm.fr/spip.php?article265&amp;lang=en" class="">Crocus</a>, into the LIS framework. These models, when run at the scale of ~100 meters, will enable simulation of wind redistribution, snow grain size, and other important processes for more accurate snow modeling.</p><p>Development of LIS is led by the <a target="_blank" rel="noreferrer" href="https://earth.gsfc.nasa.gov/hydro" class="">Hydrological Sciences Laboratory</a> at <a target="_blank" rel="noreferrer" href="https://www.nasa.gov/goddard" class="">NASA’s Goddard Space Flight Center</a>. (Figure above provided by the LIS team)</p></div><div id="ndAMpI6dz0" class="relative group/block"><h3 id="working-with-modeled-output" class="relative group"><span class="heading-text">Working with Modeled Output</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#working-with-modeled-output" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Here we will use sample model output from a <strong>LIS-SnowModel</strong> simulation over a <strong>western Colorado domain</strong>. Daily estimates of <strong>SWE, snow depth, and snow density</strong> are written to output. The SnowModel simulation has a <strong>spatial resolution of 100 m</strong>. We’ve provided four years of output, though here we’ll mostly use output from water year 2020.</p><p>Below, we’ll walk through how to open and interact with the LIS-SnowModel output. Our main objectives are to demonstrate how to do the following with a gridded dataset like LIS-SnowModel:</p><ul><li><p>Understand attributes of model data file and available variables</p></li><li><p>Create a spatial map of model output</p></li><li><p>Create time series at a point and averaged across domain</p></li><li><p>Compare LIS-SnowModel to raster and point data</p></li><li><p>Create a visualization for quick evaluation of model estimates</p></li></ul></div><div id="hzyQX93gxS" class="relative group/block"><h3 id="import-libraries" class="relative group"><span class="heading-text">Import Libraries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#import-libraries" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="WVznOrtNlJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># interface to Amazon S3 filesystem
import s3fs

# interact with n-d arrays
import numpy as np
import xarray as xr

# interact with tabular data (incl. spatial)
import pandas as pd
import geopandas as gpd

# interactive plots
import holoviews as hv
import geoviews as gv
import hvplot.pandas
import hvplot.xarray
# set bokeh as the holoviews plotting backend
#hv.extension(&#x27;bokeh&#x27;)
# set holoviews backend to Bokeh
#gv.extension(&#x27;bokeh&#x27;)

# used to find nearest grid cell to a given location
from scipy.spatial import distance

import fsspec
from datetime import datetime as dt

from geoviews import opts
from geoviews import tile_sources as gvts
from datashader.colors import viridis
import datashader
from holoviews.operation.datashader import datashade, shade, dynspread, spread, rasterize
from holoviews.streams import Selection1D, Params
import panel as pn
import param as pm
import warnings
import holoviews.operation.datashader as hd
warnings.filterwarnings(&quot;ignore&quot;)

pn.extension()
pn.param.ParamMethod.loading_indicator =True</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Sj0PP9gYKEiY6ho2VKood" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">ModuleNotFoundError</span><span>                       Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[1]</span><span style="color:rgb(0, 187, 0)">, line 2</span><span>
</span><span style="color:rgb(0, 187, 0)">      1</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># interface to Amazon S3 filesystem</span><span>
</span><span style="color:rgb(0, 187, 0)">----&gt; </span><span style="color:rgb(0, 187, 0)">2</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">s3fs</span><span>
</span><span style="color:rgb(0, 187, 0)">      4</span><span> </span><span style="color:rgb(95, 135, 135);font-style:italic"># interact with n-d arrays</span><span>
</span><span style="color:rgb(0, 187, 0)">      5</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">numpy</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 135, 0);font-weight:bold">as</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">np</span><span>

</span><span style="color:rgb(187, 0, 0)">ModuleNotFoundError</span><span>: No module named &#x27;s3fs&#x27;</span></code></pre></div></div></div><div id="FAPKBHY03V" class="relative group/block"><h3 id="load-the-lis-snowmodel-output" class="relative group"><span class="heading-text">Load the LIS-SnowModel Output</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-the-lis-snowmodel-output" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The <code>xarray</code> library makes working with labelled n-dimensional arrays easy and efficient. If you’re familiar with the <code>pandas</code> library it should feel pretty familiar.</p><p>Here we load the LIS-SnowModel output into an <code>xarray.Dataset</code> object:</p></div><div id="yMqc41WiG5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># create S3 filesystem object
s3 = s3fs.S3FileSystem(anon=False)

# define the name of our S3 bucket
bucket_name = &#x27;eis-dh-hydro/SNOWEX-HACKWEEK&#x27;

# define path to store on S3
lis_output_s3_path_time_chunk = f&#x27;s3://{bucket_name}/2022/ZARR/SURFACEMODEL/LIS_HIST_rechunkedV4.d01.zarr&#x27;
lis_output_s3_path = f&#x27;s3://{bucket_name}/2022/ZARR/SURFACEMODEL/LIS_HIST_default_chunks.d01.zarr/&#x27;

# create key-value mapper for S3 object (required to read data stored on S3)
lis_output_mapper = s3.get_mapper(lis_output_s3_path)
lis_output_mapper_tc = s3.get_mapper(lis_output_s3_path_time_chunk)

# open the dataset
lis_output_ds = xr.open_zarr(lis_output_mapper, consolidated=True)
lis_output_ds_tc = xr.open_zarr(lis_output_mapper_tc, consolidated=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZxeCiF1XVFCDIoOCpjK9I" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RjxCS5Ikt8" class="relative group/block"><h3 id="explore-the-data" class="relative group"><span class="heading-text">Explore the Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#explore-the-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Display an interactive widget for inspecting the dataset by running a cell containing the variable name. Expand the dropdown menus and click on the document and database icons to inspect the variables and attributes.</p></div><div id="qjqcDHbnc3" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lis_output_ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iYPFZxjCw2YMMeWtTXpsE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="k3C86WsTSY" class="relative group/block"><h4 id="accessing-attributes" class="relative group"><span class="heading-text">Accessing Attributes</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#accessing-attributes" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="lZCjsuWVZH" class="relative group/block"><p>Dataset attributes (metadata) are accessible via the <code>attrs</code> attribute:</p></div><div id="zdUQ0efkGC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lis_output_ds.attrs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FvVG-K8L6HqiBqFrHqlNd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zLQr1Ysbc2" class="relative group/block"><h4 id="accessing-variables" class="relative group"><span class="heading-text">Accessing Variables</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#accessing-variables" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Variables can be accessed using either <strong>dot notation</strong> or <strong>square bracket notation</strong>. Here we will stick with square bracket notation:</p></div><div id="ek8cWuUXQ1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># square bracket notation
lis_output_ds[&#x27;SM_SnowDepth_inst&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="x71IOZODjN4FrENmIRaD7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vT6YFx9DPB" class="relative group/block"><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Watch out for large datasets!</div></div><div class="myst-admonition-body px-4 py-1"><p>Note that the 4-ish years of model output (1694 daily time steps for a domain of size 6650 x 4800) has a size of over <strong>200 gb</strong>! As we’ll see below, this is just for an area over western Colorado. If we’re interested in modeling the western United States or CONUS or even global at high resolution, we need to be prepared to work with some large datasets.</p></div></aside></div><div id="HlSYEkFmlg" class="relative group/block"><h4 id="dimensions-and-coordinate-variables" class="relative group"><span class="heading-text">Dimensions and Coordinate Variables</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#dimensions-and-coordinate-variables" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>The dimensions and coordinate variable fields put the “<em>labelled</em>” in “labelled n-dimensional arrays”:</p><ul><li><p><strong>Dimensions:</strong> labels for each dimension in the dataset (e.g., <code>time</code>)</p></li><li><p><strong>Coordinates:</strong> labels for indexing along dimensions (e.g., <code>&#x27;2020-01-01&#x27;</code>)</p></li></ul><p>We can use these labels to select, slice, and aggregate the dataset.</p></div><div id="EWR2pgm0Ai" class="relative group/block"><h4 id="subsetting-in-space-or-time" class="relative group"><span class="heading-text">Subsetting in Space or Time</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#subsetting-in-space-or-time" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p><code>xarray</code> provides two methods for selecting or subsetting along coordinate variables:</p><ul><li><p>index selection: <code>ds.isel(time=0)</code></p></li><li><p>value selection <code>ds.sel(time=&#x27;2020-01-01&#x27;)</code></p></li></ul><p>For example, we can use value selection to select based on the the coorindates of a given dimension:</p></div><div id="PTXqixZbl3" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lis_output_ds.sel(time=&#x27;2020-01-01&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C5HqQz7N6ni1kWhWaNWAt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OMXnKyYPOY" class="relative group/block"><p>The <code>.sel()</code> approach also allows the use of shortcuts in some cases. For example, here we select all timesteps in the month of January 2020. Note that length of the time dimension is now only 31.</p></div><div id="cD3C8ssi0Z" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lis_output_ds.sel(time=&#x27;2020-01&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MSTdsji91ioSv_TcNsmdp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WTpYTFxH7U" class="relative group/block"><h5 id="latitude-and-longitude" class="relative group"><span class="heading-text">Latitude and Longitude</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#latitude-and-longitude" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><p>You may have noticed that latitude (<code>lat</code>) and longitude (<code>lon</code>) are not listed as dimensions. This dataset would be easier to work with if <code>lat</code> and <code>lon</code> were coordinate variables and dimensions. Here we define a helper function that reads the spatial information from the dataset attributes, generates arrays containing the <code>lat</code> and <code>lon</code> values, and appends them to the dataset:</p></div><div id="FyxDDwhSxe" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def add_latlon_coords(dataset: xr.Dataset)-&gt;xr.Dataset:
    &quot;&quot;&quot;Adds lat/lon as dimensions and coordinates to an xarray.Dataset object.&quot;&quot;&quot;
    
    # get attributes from dataset
    attrs = dataset.attrs
    
    # get x, y resolutions
    dx = .001 #round(float(attrs[&#x27;DX&#x27;]), 3)
    dy = .001 #round(float(attrs[&#x27;DY&#x27;]), 3)
       
    # get grid cells in x, y dimensions
    ew_len = len(dataset[&#x27;east_west&#x27;])
    ns_len = len(dataset[&#x27;north_south&#x27;])
    
    # get lower-left lat and lon
    ll_lat = round(float(attrs[&#x27;SOUTH_WEST_CORNER_LAT&#x27;]), 3)
    ll_lon = round(float(attrs[&#x27;SOUTH_WEST_CORNER_LON&#x27;]), 3)
    
    # calculate upper-right lat and lon
    ur_lat =  41.5122 #ll_lat + (dy * ns_len)
    ur_lon = -103.9831 #ll_lon + (dx * ew_len)
    
    # define the new coordinates
    coords = {
        # create an arrays containing the lat/lon at each gridcell
        &#x27;lat&#x27;: np.linspace(ll_lat, ur_lat, ns_len, dtype=np.float32, endpoint=False).round(4),
        &#x27;lon&#x27;: np.linspace(ll_lon, ur_lon, ew_len, dtype=np.float32, endpoint=False).round(4)
    }
    
    lon_attrs = dataset.lon.attrs
    lat_attrs = dataset.lat.attrs
    
    # rename the original lat and lon variables
    dataset = dataset.rename({&#x27;lon&#x27;:&#x27;orig_lon&#x27;, &#x27;lat&#x27;:&#x27;orig_lat&#x27;})
    # rename the grid dimensions to lat and lon
    dataset = dataset.rename({&#x27;north_south&#x27;: &#x27;lat&#x27;, &#x27;east_west&#x27;: &#x27;lon&#x27;})
    # assign the coords above as coordinates
    dataset = dataset.assign_coords(coords)
    dataset.lon.attrs = lon_attrs
    dataset.lat.attrs = lat_attrs
    
    
    return dataset</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KMc2u4E_vaMIl4pHsvQ2W" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Z1qFp283EL" class="relative group/block"><p>Now that the function is defined, let’s use it to append <code>lat</code> and <code>lon</code> coordinates to the LIS output:</p></div><div id="FZx1XGXFqR" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lis_output_ds = add_latlon_coords(lis_output_ds)
lis_output_ds_tc = add_latlon_coords(lis_output_ds_tc)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9ajI_3ewsWV6TV8jeOkpa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="sG5ELd68SX" class="relative group/block"><p>Inspect the dataset:</p></div><div id="qXcBvYJ04j" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lis_output_ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EBYbWr8gSrr7POpo8nM6I" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="QMF90bl2fj" class="relative group/block"><p>Now <code>lat</code> and <code>lon</code> are listed as coordinate variables and have replaced the <code>north_south</code> and <code>east_west</code> dimensions. This will make it easier to spatially subset the dataset!</p></div><div id="M9sytlQrRH" class="relative group/block"><h5 id="basic-spatial-subsetting" class="relative group"><span class="heading-text">Basic Spatial Subsetting</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#basic-spatial-subsetting" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="Fa8S2U7m7G" class="relative group/block"><p>We can use the <code>slice()</code> function on the <code>lat</code> and <code>lon</code> dimensions to select data between a range of latitudes and longitudes:</p></div><div id="iI9IQrH6cL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># uncomment line below to work with the full domain -&gt; this will be much slower!
#lis_output_ds.sel(lat=slice(35.5, 41), lon=slice(-109, -104))

# just Grand Mesa -&gt; smaller domain for faster run times
# note the smaller lat/lon extents in the dimensions
lis_output_ds.sel(lat=slice(38.6, 39.4), lon=slice(-108.6, -107.1))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zDvU1sfgC1z_AANfPhjjq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="J4kvfph8g9" class="relative group/block"><p>Notice how the sizes of the <code>lat</code> and <code>lon</code> dimensions have decreased.</p></div><div id="FPX6L3JzlS" class="relative group/block"><h5 id="subset-across-multiple-dimensions" class="relative group"><span class="heading-text">Subset Across Multiple Dimensions</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#subset-across-multiple-dimensions" title="Link to this Section" aria-label="Link to this Section">¶</a></h5></div><div id="VNGW6iucfk" class="relative group/block"><p>Now we will combine the above examples for subsetting both spatially and temporally:</p></div><div id="jwQvRMoEDa" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># define a range of dates to select
wy_2020_slice = slice(&#x27;2019-10-01&#x27;, &#x27;2020-09-30&#x27;)

# define lat/lon for Grand Mesa area
lat_slice = slice(38.6, 39.4)
lon_slice = slice(-108.6, -107.1)

# select the snow depth and subset to wy_2020_slice
snd_GM_wy2020_ds = lis_output_ds[&#x27;SM_SnowDepth_inst&#x27;].sel(time=wy_2020_slice, lat=lat_slice, lon=lon_slice)
snd_GM_wy2020_ds_tc = lis_output_ds_tc[&#x27;SM_SnowDepth_inst&#x27;].sel(time=wy_2020_slice, lat=lat_slice, lon=lon_slice)

# inspect resulting dataset
snd_GM_wy2020_ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FpublfN1XVTPI0xtVFKeE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="rdu5nKwFKQ" class="relative group/block"><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Subset for more manageable sizes!</div></div><div class="myst-admonition-body px-4 py-1"><p>We’ve now subsetted both spatially (down to just Grand Mesa domain) and temporally (water year 2020). Note the smaller size of the data array -&gt; <strong>a decrease from over 200 gb to 1.7 gb</strong>! This smaller dataset will be much easier to work with, but feel free to try some of the commands with the full dataset, just give it a few minutes to process!</p></div></aside></div><div id="fKLvw7X3UV" class="relative group/block"><h4 id="plotting" class="relative group"><span class="heading-text">Plotting</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plotting" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>We’ve imported two plotting libraries:</p><ul><li><p><code>matplotlib</code>: static plots</p></li><li><p><code>hvplot</code>: interactive plots</p></li></ul><p>We can make a quick <code>matplotlib</code>-based plot for the subsetted data using the <code>.plot()</code> function supplied by <code>xarray.Dataset</code> objects. For this example, we’ll select one day and plot it:</p></div><div id="IWKMnAWDEN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># simple matplotlilb plot
snd_GM_wy2020_ds.sel(time=&#x27;2020-01-01&#x27;).plot();</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="affJoJvS8aQIftrHYYBHA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="dPXL6q37i4" class="relative group/block"><p>Similarly we can make an interactive plot using the <code>hvplot</code> accessor and specifying a <code>quadmesh</code> plot type:</p></div><div id="VcTccbYDDC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># hvplot based map
snd_GM_20200101_plot = snd_GM_wy2020_ds.sel(time=&#x27;2020-01-01&#x27;).hvplot.quadmesh(geo=True, rasterize=True, project=True,
                                                                               xlabel=&#x27;lon&#x27;, ylabel=&#x27;lat&#x27;, cmap=&#x27;viridis&#x27;,
                                                                               tiles=&#x27;EsriImagery&#x27;)

snd_GM_20200101_plot</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KTu_K4Myz1ypIoV2jhS3-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RiFYBo7qOS" class="relative group/block"><p>Pan, zoom, and scroll around the map. Hover over the LIS-SnowModel data to see the data values.</p></div><div id="s5RAbBX8Sf" class="relative group/block"><p>If we try to plot more than one time-step <code>hvplot</code> will also provide a time-slider we can use to scrub back and forth in time:</p><p><strong>Note:</strong> the time-slider below will only work running in Jupyter Lab (not on the snowex website)</p></div><div id="AgArKyvgeu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">snd_GM_wy2020_ds.sel(time=&#x27;2020-01&#x27;).hvplot.quadmesh(geo=True, rasterize=True, project=True,
                             xlabel=&#x27;lon&#x27;, ylabel=&#x27;lat&#x27;, cmap=&#x27;viridis&#x27;,
                             tiles=&#x27;EsriImagery&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EJ5oTI1EK5f4D-T59zDmZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="jfLf0kl2iP" class="relative group/block"><p>From here on out we will stick with <code>hvplot</code> for plotting.</p></div><div id="MSbyzwA8kD" class="relative group/block"><h5 id="timeseries-plots" class="relative group"><span class="heading-text">Timeseries Plots</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#timeseries-plots" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><p>We can generate a timeseries for a given grid cell by selecting and calling the plot function:</p></div><div id="zvuSHL7Pw2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># define point to take timeseries (note: must be present in coordinates of dataset)
ts_lon, ts_lat = (-107.8702, 39.0504)

# plot timeseries
snd_GM_wy2020_ds_tc.sel(lat=ts_lat, lon=ts_lon).hvplot.line(title=f&#x27;Snow Depth Timeseries @ Lon: {ts_lon}, Lat: {ts_lat}&#x27;,
                                                   xlabel=&#x27;Date&#x27;, ylabel=&#x27;Snow Depth (m)&#x27;) + \
    snd_GM_20200101_plot * gv.Points([(ts_lon, ts_lat)]).opts(size=10, color=&#x27;red&#x27;)
    </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="W3ctZI6eh32l6t-jEG47b" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xZP91y9e3r" class="relative group/block"><p>In the next section we’ll learn how to create a timeseries over a broader area.</p></div><div id="ZcVcYi1RE4" class="relative group/block"><h3 id="aggregation" class="relative group"><span class="heading-text">Aggregation</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#aggregation" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We can perform aggregation operations on the dataset such as <code>min()</code>, <code>max()</code>, <code>mean()</code>, and <code>sum()</code> by specifying the dimensions along which to perform the calculation.</p><p>For example we can calculate the daily mean snow depth for the region around Grand Mesa for water year 2020:</p></div><div id="eyk0vJMmYB" class="relative group/block"><h4 id="area-average" class="relative group"><span class="heading-text">Area Average</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#area-average" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="VcRCsojvk2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># take area-averaged mean at each timestep
mean_snd_GM_wy2020_ds = snd_GM_wy2020_ds_tc.mean([&#x27;lat&#x27;, &#x27;lon&#x27;])

# inspect the dataset
mean_snd_GM_wy2020_ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="100jJ2j_L_QDvh69oeL3Y" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Ih1hLR60Es" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># plot timeseries (hvplot knows how to plot based on dataset&#x27;s dimensionality!)
mean_snd_GM_wy2020_ds.hvplot(title=&#x27;Mean LIS-SnowModel Snow Depth for Grand Mesa area&#x27;, xlabel=&#x27;Date&#x27;, ylabel=&#x27;Snow Depth (m)&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="I4epBpuAntDuA8ZUpziEL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UuVWo7cEto" class="relative group/block"><h3 id="comparing-model-output" class="relative group"><span class="heading-text">Comparing Model Output</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#comparing-model-output" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now that we’re familiar with the model output, let’s compare it to two other datasets: SNODAS (raster) and SNOTEL (point).</p></div><div id="vanmAEEY84" class="relative group/block"><h4 id="lis-snowmodel-raster-vs-snodas-raster" class="relative group"><span class="heading-text">LIS-SnowModel (raster) vs. SNODAS (raster)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lis-snowmodel-raster-vs-snodas-raster" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="X5r5eKLyIa" class="relative group/block"><p>First, we’ll load the SNODAS dataset which we also have hosted on S3 as a Zarr store. This command will take a minute or two to run.</p></div><div id="X3I2rkeFJD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># load SNODAS dataset

#snodas depth
key = &quot;SNODAS/snodas_snowdepth_20161001_20200930.zarr&quot;    
snodas_depth_ds = xr.open_zarr(s3.get_mapper(f&quot;{bucket_name}/{key}&quot;), consolidated=True)

# apply scale factor to convert to meters (0.001 per SNODAS user guide)
snodas_depth_ds = snodas_depth_ds * 0.001</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NSu2EWhnnNRswoTVXQsAg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Lg9JhUAKg1" class="relative group/block"><p>Next we define a helper function to extract the (lon, lat) of the nearest grid cell to a given point:</p></div><div id="airbeJVedT" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def nearest_grid(ds, pt):
    
    &quot;&quot;&quot;
    Returns the nearest lon and lat to pt in a given Dataset (ds).
    
    pt : input point, tuple (longitude, latitude)
    output:
        lon, lat
    &quot;&quot;&quot;
    
    if all(coord in list(ds.coords) for coord in [&#x27;lat&#x27;, &#x27;lon&#x27;]):
        df_loc = ds[[&#x27;lon&#x27;, &#x27;lat&#x27;]].to_dataframe().reset_index()
    else:
        df_loc = ds[[&#x27;orig_lon&#x27;, &#x27;orig_lat&#x27;]].isel(time=0).to_dataframe().reset_index()
    
    loc_valid = df_loc.dropna()
    pts = loc_valid[[&#x27;lon&#x27;, &#x27;lat&#x27;]].to_numpy()
    idx = distance.cdist([pt], pts).argmin()
    
    return loc_valid[&#x27;lon&#x27;].iloc[idx], loc_valid[&#x27;lat&#x27;].iloc[idx]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2Lczo2P8TMARkJl6mz7_F" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Hx7ni0oDkp" class="relative group/block"><p>The next cell will look pretty similar to what we did earlier to plot a timeseries of a single point in the LIS-SnowModel data. The general steps are:</p><ul><li><p>Extract the coordinates of the SNODAS grid cell nearest to our LIS-SnowModel grid cell (<code>ts_lon</code> and <code>ts_lat</code> from earlier)</p></li><li><p>Subset the SNODAS and LIS-SnowModel data to the grid cells and date ranges of interest</p></li><li><p>Create the plots!</p></li></ul></div><div id="vmk2tjWMbC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># drop off irrelevant variables
drop_vars = [&#x27;orig_lat&#x27;, &#x27;orig_lon&#x27;]
lis_output_ds = lis_output_ds.drop(drop_vars)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="F1QNovF8SpZEfgNDoVvQp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tOlYHw1XOB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># get lon, lat of snodas grid cell nearest to the LIS coordinates we used earlier
snodas_ts_lon, snodas_ts_lat = nearest_grid(snodas_depth_ds, (ts_lon, ts_lat))

# define a date range to plot (shorter = quicker for demo)
start_date, end_date = (&#x27;2020-01-01&#x27;, &#x27;2020-06-01&#x27;)
plot_daterange = slice(start_date, end_date)

# select SNODAS grid cell and subset to plot_daterange
snodas_snd_subset_ds = snodas_depth_ds.sel(lon=snodas_ts_lon,
                                             lat=snodas_ts_lat,
                                             time=plot_daterange)

# select LIS grid cell and subset to plot_daterange
lis_snd_subset_ds = lis_output_ds[&#x27;SM_SnowDepth_inst&#x27;].sel(lat=ts_lat,
                                                        lon=ts_lon,
                                                        time=plot_daterange)

# create SNODAS snow depth plot
snodas_snd_plot = snodas_snd_subset_ds.hvplot(label=&#x27;SNODAS&#x27;)

# create LIS snow depth plot
lis_snd_plot = lis_snd_subset_ds.hvplot(label=&#x27;LIS-SnowModel&#x27;)

# create SNODAS vs LIS snow depth plot
lis_vs_snodas_snd_plot = (lis_snd_plot * snodas_snd_plot)

# display the plot
lis_vs_snodas_snd_plot.opts(title=f&#x27;Snow Depth @ Lon: {ts_lon}, Lat: {ts_lat}&#x27;,
                            legend_position=&#x27;right&#x27;,
                            xlabel=&#x27;Date&#x27;,
                            ylabel=&#x27;Snow Depth (m)&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9diR-R2isG6jZTR2wLqRN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pBwBX6JWZ7" class="relative group/block"><h4 id="lis-snowmodel-raster-vs-snodas-raster-vs-snotel-point" class="relative group"><span class="heading-text">LIS-SnowModel (raster) vs. SNODAS (raster) vs. SNOTEL (point)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lis-snowmodel-raster-vs-snodas-raster-vs-snotel-point" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Now let’s add SNOTEL point data to our plot.</p><p>First, we’re going to define some helper functions to load the SNOTEL data:</p></div><div id="jydGidgep8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># load csv containing metadata for SNOTEL sites in a given state (e.g,. &#x27;colorado&#x27;)
def load_site(state):
    
    # define the path to the file
    key = f&quot;SNOTEL/snotel_{state}.csv&quot;
    
    # load the csv into a pandas DataFrame
    df = pd.read_csv(s3.open(f&#x27;s3://{bucket_name}/{key}&#x27;, mode=&#x27;r&#x27;))
    
    return df

# load SNOTEL data for a specific site
def load_snotel_txt(state, var):
    
    # define the path to the file
    key = f&quot;SNOTEL/snotel_{state}{var}_20162020.txt&quot;
    
    # determine how many lines to skip in the file (they start with #)
    fh = s3.open(f&quot;{bucket_name}/{key}&quot;)
    lines = fh.readlines()
    skips = sum(1 for ln in lines if ln.decode(&#x27;ascii&#x27;).startswith(&#x27;#&#x27;))
    
    # load the data into a pandas DataFrame
    df = pd.read_csv(s3.open(f&quot;s3://{bucket_name}/{key}&quot;), skiprows=skips)
    
    # convert the Date column from strings to datetime objects
    df[&#x27;Date&#x27;] = pd.to_datetime(df[&#x27;Date&#x27;])
    return df</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0lSs2WJII623GDUH7EW__" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="FqPYibXnsv" class="relative group/block"><p>For the purposes of this tutorial let’s load the SNOTEL data for sites in Colorado. We’ll pick one site to plot in a few cells.</p></div><div id="YVgIk7z74f" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># load SNOTEL snow depth for Colorado into a dictionary
snotel_depth = {&#x27;CO&#x27;: load_snotel_txt(&#x27;CO&#x27;, &#x27;depth&#x27;)}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KVZaONUZxqydOJmZmgIof" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yOngdaripy" class="relative group/block"><p>We’ll need another helper function to load the depth data:</p></div><div id="rZEgq6DgfC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># get snotel depth
def get_depth(state, site, start_date, end_date):
    
    # grab the depth for the given state (e.g., CO)
    df = snotel_depth[state]
    
    # define a date range mask
    mask = (df[&#x27;Date&#x27;] &gt;= start_date) &amp; (df[&#x27;Date&#x27;] &lt;= end_date)
    
    # use mask to subset between time range
    df = df.loc[mask]
    
    # extract timeseries for the given site
    return pd.concat([df.Date, df.filter(like=site)], axis=1).set_index(&#x27;Date&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iPrC985G3RXOFTiY2X-m2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Gqpv3BSUYm" class="relative group/block"><p>Load the site metadata for Colorado:</p></div><div id="UzlQwHZNPy" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">co_sites = load_site(&#x27;colorado&#x27;)

# peek at the first 5 rows
co_sites.head()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2JUHUxgOOSAZ-Mh1nU6S2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="m2vtWluu38" class="relative group/block"><p>The point we’ve been using so far in the tutorial actually corresponds to the coordinates for the Park Reservoir SNOTEL on Grand Mesa! Let’s extract the site data for that point:</p></div><div id="DIKfWrXqDj" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># get the depth data by passing the site name to the get_depth() function
park_res_snd_df = get_depth(&#x27;CO&#x27;, &#x27;Park Reservoir (682)&#x27;, start_date, end_date)

# convert from cm to m
park_res_snd_df = park_res_snd_df / 100</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZrlGxww2kzF433QWlpPr7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pg6BjiOGiz" class="relative group/block"><p>Now we’re ready to plot:</p></div><div id="iwRVlPpgNK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># create SNOTEL plot
park_res_plot = park_res_snd_df.hvplot(label=&#x27;SNOTEL&#x27;)

# combine the SNOTEl plot with the LIS vs SNODAS plot
(lis_vs_snodas_snd_plot * park_res_plot).opts(title=f&#x27;Snow Depth @ Lon: {ts_lon}, Lat: {ts_lat}&#x27;, legend_position=&#x27;right&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="x5vPLS2j6wemnWqvONihP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="nkzNdAZtVs" class="relative group/block"><h2 id="interactive-data-exploration" class="relative group"><span class="heading-text">Interactive Data Exploration</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#interactive-data-exploration" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p><strong>Note:You must run the following code in JupyterLab for interactivity</strong></p><p>We’ve now built up the separate pieces for visualizing LIS-SnowModel output spatially and temporally, and we’ve combined our time series with those from SNOTEL stations and SNODAS. Now we can bring it all together in an interactive tool.</p><p>The code in the cells below will generate an interactive panel for comparing of LIS-SnowModel output, SNODAS, and SNOTEL snow depth and snow water equivalent at SNOTEL site locations.</p><p><strong>Note: some cells below take several minutes to run and some aspects of the interactive widgets may not work in the rendered version on the Hackweek site.</strong></p></div><div id="Gkk45ZGanc" class="relative group/block"><h3 id="load-data" class="relative group"><span class="heading-text">Load Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="CiczRLnDu3" class="relative group/block"><h4 id="snotel-sites-info" class="relative group"><span class="heading-text">SNOTEL Sites info</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#snotel-sites-info" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="FcOpwBkBdX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># create dictionary linking state names and abbreviations
snotel = {&quot;CO&quot; : &quot;colorado&quot;,
          &quot;ID&quot; : &quot;idaho&quot;,
          &quot;NM&quot; : &quot;newmexico&quot;,
          &quot;UT&quot; : &quot;utah&quot;,
          &quot;WY&quot; : &quot;wyoming&quot;}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="a1slbZ1fpShacUvBDXs9l" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="HjwivbdJDX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># load SNOTEL site metadata for sites in the given state
def load_site(state):
    
    # define path to file
    key = f&quot;SNOTEL/snotel_{state}.csv&quot;
    
    # load csv into pandas DataFrame
    df = pd.read_csv(s3.open(f&#x27;{bucket_name}/{key}&#x27;, mode=&#x27;r&#x27;))
    
    return df </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="rWIBjuBy7ASVQXeypxT3B" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="INk9cPgyHV" class="relative group/block"><h4 id="snotel-depth-swe" class="relative group"><span class="heading-text">SNOTEL Depth &amp; SWE</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#snotel-depth-swe" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="DXW0Tp3iDu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">def load_snotel_txt(state, var):
    
    # define path to file
    key = f&quot;SNOTEL/snotel_{state}{var}_20162020.txt&quot;

    # open text file
    fh = s3.open(f&quot;{bucket_name}/{key}&quot;)
    
    # read each line and note those that begin with &#x27;#&#x27;
    lines = fh.readlines()
    skips = sum(1 for ln in lines if ln.decode(&#x27;ascii&#x27;).startswith(&#x27;#&#x27;))
    
    # load txt file into pandas DataFrame (skipping lines beginning with &#x27;#&#x27;)
    df = pd.read_csv(s3.open(f&quot;{bucket_name}/{key}&quot;), skiprows=skips)
    
    # convert Date column from str to pandas datetime objects
    df[&#x27;Date&#x27;] = pd.to_datetime(df[&#x27;Date&#x27;])
    return df</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="s833LrOLYmHMQPldysUOC" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="aB13zDCk1B" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># load SNOTEL depth &amp; swe into dictionaries

# define empty dicts
snotel_depth = {}
snotel_swe = {}

# loop over states and load SNOTEL data
for state in snotel.keys():
    print(f&quot;Loading state {state}&quot;)
    snotel_depth[state] = load_snotel_txt(state, &#x27;depth&#x27;)
    snotel_swe[state] = load_snotel_txt(state, &#x27;swe&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JyOAgtcoO0g53vqNBfP_r" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="I4BZE5o1gX" class="relative group/block"><h4 id="snodas-swe" class="relative group"><span class="heading-text">SNODAS SWE</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#snodas-swe" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>We’ve already loaded in SNODAS snow depths, but here we’ll load in SWE. As above, this cell might take a few minutes to run since it’s a large dataset to read.</p></div><div id="BZiepLdOL5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># load snodas swe data
key = &quot;SNODAS/snodas_swe_20161001_20200930.zarr&quot;
snodas_swe_ds = xr.open_zarr(s3.get_mapper(f&quot;{bucket_name}/{key}&quot;), consolidated=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tB_mxIIbj4pdw2oVPSfhH" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="M1gq8SdIyE" class="relative group/block"><h4 id="lis-snowmodel-outputs" class="relative group"><span class="heading-text">LIS-SnowModel Outputs</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lis-snowmodel-outputs" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="K5cA5jD6TC" class="relative group/block"><p>We’ve already read in the LIS-SnowModel data above. Here we subset by time for October 2019 - June 2020.</p></div><div id="z2n0DpC04n" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># subset LIS data for winter 2020 
time_range = slice(&#x27;2019-10-01&#x27;, &#x27;2020-06-30&#x27;)
lis_sf = lis_output_ds_tc.sel(time=time_range)
lis_sf = lis_sf.drop(drop_vars)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EpS3InSyObKW3GnmqKrC7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Upql5GTvYq" class="relative group/block"><p>In the next cell, we extract the data variable names and timesteps from the LIS outputs. These will be used to define the widget options.</p></div><div id="xzeWquvUrf" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># gather metadata from LIS
# get variable names:string
vnames = list(lis_sf.data_vars)
print(vnames)

# get time-stamps:string
tstamps = list(np.datetime_as_string(lis_sf.time.values, &#x27;D&#x27;))
print(len(tstamps), tstamps[0], tstamps[-1])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="e_XSLsYBgksWGm3zmsSC0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WaqtbwVMxE" class="relative group/block"><p>By default, the <code>holoviews</code> plotting library automatically adjusts the range of plot colorbars based on the range of values in the data being plotted. This may not be ideal when comparing data on different timesteps. In the next cell we assign the upper and lower bounds for each data variable which we’ll later use to set a static colorbar range.</p></div><div id="hExnJ7yTyd" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cmap_lims = {&#x27;SM_SWE_inst&#x27;: (0.0, 3.0),
 &#x27;SM_SnowDensity_inst&#x27;: (100, 550.0),
 &#x27;SM_SnowDepth_inst&#x27;: (0.0, 6.5)}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="WRR5KHSuELipPLBXz3FkN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tqRZOalJlr" class="relative group/block"><h3 id="interactive-widget" class="relative group"><span class="heading-text">Interactive Widget</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#interactive-widget" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><h4 id="snotel-site-map-and-timeseries" class="relative group"><span class="heading-text">SNOTEL Site Map and Timeseries</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#snotel-site-map-and-timeseries" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>The two cells that follow will create an interactive panel for comparing LIS-SnowModel, SNODAS, and SNOTEL snow depth and snow water equivalent. The SNOTEL site locations are plotted as points on an interactive map for each state. Hover over the sites to view metadata and click on a site to generate a timeseries!</p><p><strong>Note: it will take some time for the timeseries to display.</strong></p></div><div id="Wy1mDTeKoQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># get snotel depth
def get_depth(state, site, ts, te):
    df = snotel_depth[state]
    
    # subset between time range
    mask = (df[&#x27;Date&#x27;] &gt;= ts) &amp; (df[&#x27;Date&#x27;] &lt;= te)
    df = df.loc[mask]
    
    # extract timeseries for the site
    return pd.concat([df.Date, df.filter(like=site)], axis=1).set_index(&#x27;Date&#x27;)

# get snotel swe
def get_swe(state, site, ts, te):
    df = snotel_swe[state]
    
    # subset between time range
    mask = (df[&#x27;Date&#x27;] &gt;= ts) &amp; (df[&#x27;Date&#x27;] &lt;= te)
    df = df.loc[mask]
    
    # extract timeseries for the site
    return pd.concat([df.Date, df.filter(like=site)], axis=1).set_index(&#x27;Date&#x27;)

# co-locate site &amp; LIS-SnowModel model cell
def nearest_grid(pt):
    # pt : input point, tuple (longtitude, latitude)
    # output:
    #        x_idx, y_idx 
    loc_valid = df_loc.dropna()
    pts = loc_valid[[&#x27;lon&#x27;, &#x27;lat&#x27;]].to_numpy()
    idx = distance.cdist([pt], pts).argmin()

    return loc_valid[&#x27;east_west&#x27;].iloc[idx], loc_valid[&#x27;north_south&#x27;].iloc[idx]

# get LIS-SnowModel variable 
def var_subset(dset, v, lon, lat, ts, te):
    return dset[v].sel(lon=lon, lat=lat, method=&quot;nearest&quot;).sel(time=slice(ts, te)).load()

# line plots
def line_callback(index, state, vname, ts_tag, te_tag):
    sites = load_site(snotel[state])
    row = sites.iloc[1]
    
    tmp = var_subset(lis_sf, vname, row.lon, row.lat, ts_tag, te_tag) 
    xr_sf = xr.zeros_like(tmp)
    
    xr_snodas = xr_sf
    
    ck = get_depth(state, row.site_name, ts_tag, te_tag).to_xarray().rename({&#x27;Date&#x27;: &#x27;time&#x27;})
    xr_snotel = xr.zeros_like(ck)
    
    if not index:
        title=&#x27;Var: -- Lon: -- Lat: --&#x27;
        return (xr_sf.hvplot(title=title, color=&#x27;blue&#x27;, label=&#x27;LIS-SnowModel&#x27;) \
                * xr_snotel.hvplot(color=&#x27;red&#x27;, label=&#x27;SNOTEL&#x27;) \
                * xr_snodas.hvplot(color=&#x27;green&#x27;, label=&#x27;SNODAS&#x27;)).opts(legend_position=&#x27;right&#x27;)
        

    else:
        sites = load_site(snotel[state])
        first_index = index[0]
        row = sites.iloc[first_index]
    
        
        xr_sf = var_subset(lis_sf, vname, row.lon, row.lat, ts_tag, te_tag)
    
        vs = vname.split(&#x27;_&#x27;)[1]
        title=f&#x27;Var: {vs} Lon: {row.lon} Lat: {row.lat}&#x27;

        
        # update snotel data 
        if &#x27;depth&#x27; in vname.lower():
            xr_snotel =  get_depth(state, row.site_name, ts_tag, te_tag).to_xarray().rename({&#x27;Date&#x27;: &#x27;time&#x27;})*0.01
            xr_snodas =  var_subset(snodas_depth_ds, &#x27;SNOWDEPTH&#x27;, row.lon, row.lat, ts_tag, te_tag)
        
        if &#x27;swe&#x27; in vname.lower():
            xr_snotel =  get_swe(state, row.site_name, ts_tag, te_tag).to_xarray().rename({&#x27;Date&#x27;: &#x27;time&#x27;})/1000
            xr_snodas =  var_subset(snodas_swe_ds, &#x27;SWE&#x27;, row.lon, row.lat, ts_tag, te_tag)/1000

    
        return xr_sf.hvplot(title=title, color=&#x27;blue&#x27;, label=&#x27;LIS-SnowModel&#x27;) \
               * xr_snotel.hvplot(color=&#x27;red&#x27;, label=&#x27;SNOTEL&#x27;) \
               * xr_snodas.hvplot(color=&#x27;green&#x27;, label=&#x27;SNODAS&#x27;)

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="SruFSpbeb5Zi5wXeNoNe0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="S2ozwLhsiV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># satic snowdepth as background
dds = lis_sf[&#x27;SM_SnowDepth_inst&#x27;].sel(time=&#x27;2020-02-01&#x27;).load()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="6cl_ywZx0RbtWkuUscgRS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vzBYuFjanv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># prepare the panel that will display a static plot of snow depth. Snotel sites will be plotted on top
img = dds.hvplot.quadmesh(geo=True, rasterize=True, project=True,
                             xlabel=&#x27;lon&#x27;, ylabel=&#x27;lat&#x27;, cmap=&#x27;viridis&#x27;,
                             clim=(0,1))
snow_depth_bg=hd.regrid(img)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="otUmPAU9liK725Gjz-2Ii" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="RR3b54yAOD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># sites on map
def plot_points(state):  
    # dataframe to hvplot obj Points
    sites=load_site(snotel[state])
    pts_opts=dict(size=10, nonselection_alpha=0.5,tools=[&#x27;tap&#x27;, &#x27;hover&#x27;])
    #site_points=sites.hvplot.points(x=&#x27;lon&#x27;, y=&#x27;lat&#x27;, c=&#x27;elev&#x27;, cmap=&#x27;fire&#x27;, geo=True, hover_cols=[&#x27;site_name&#x27;, &#x27;ntwk&#x27;, &#x27;state&#x27;, &#x27;lon&#x27;, &#x27;lat&#x27;]).opts(**pts_opts)  
    site_points=sites.hvplot.points(x=&#x27;lon&#x27;, y=&#x27;lat&#x27;, color=&#x27;black&#x27;,geo=True, hover_cols=[&#x27;site_name&#x27;, &#x27;ntwk&#x27;, &#x27;state&#x27;, &#x27;lon&#x27;, &#x27;lat&#x27;]).opts(**pts_opts)  
    return site_points

# base map
tiles = gvts.OSM()

# state widget
state_select = pn.widgets.Select(options=list(snotel.keys()), name=&quot;State&quot;)
state_stream = Params(state_select, [&#x27;value&#x27;], rename={&#x27;value&#x27;:&#x27;state&#x27;})

# variable widget
var_select = pn.widgets.Select(options=[&#x27;SM_SnowDepth_inst&#x27;, &#x27;SM_SWE_inst&#x27;], name=&quot;LIS Variable List&quot;)
var_stream = Params(var_select, [&#x27;value&#x27;], rename={&#x27;value&#x27;:&#x27;vname&#x27;})

# date range widget
date_fmt = &#x27;%Y-%m-%d&#x27;
sdate_input = pn.widgets.DatetimeInput(name=&#x27;Start date&#x27;, value=dt(2019,10,1),start=dt.strptime(tstamps[0], date_fmt), end=dt.strptime(tstamps[-1], date_fmt), format=date_fmt)
sdate_stream = Params(sdate_input, [&#x27;value&#x27;], rename={&#x27;value&#x27;:&#x27;ts_tag&#x27;})
edate_input = pn.widgets.DatetimeInput(name=&#x27;End date&#x27;, value=dt(2020,6,30),start=dt.strptime(tstamps[0], date_fmt), end=dt.strptime(tstamps[-1], date_fmt),format=date_fmt)
edate_stream = Params(edate_input, [&#x27;value&#x27;], rename={&#x27;value&#x27;:&#x27;te_tag&#x27;})

# generate site points as dynamic map
# plots points and calls plot_points() when user selects a site
site_dmap = hv.DynamicMap(plot_points, streams=[state_stream]).opts(height=400, width=600)
# pick site
select_stream = Selection1D(source=site_dmap)

# link widgets to callback function
line = hv.DynamicMap(line_callback, streams=[select_stream, state_stream, var_stream, sdate_stream, edate_stream])

# create panel layout
pn.Row(snow_depth_bg*site_dmap*tiles, pn.Column(state_select, var_select, pn.Row(sdate_input, edate_input), line))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pWL2mJ3VBaESkdy4iApp1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="bUv4cOzIKi" class="relative group/block"><h2 id="exercises" class="relative group"><span class="heading-text">Exercises</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#exercises" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>You now know how to see what variables are available in a typical model output file and you’ve learned how to inspect gridded model estimates both spatially and temporally. Below are a few exercises for both practicing the above skills and for becoming more familiar with the sample model output.</p><h3 id="exercise-1" class="relative group"><span class="heading-text">Exercise 1</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#exercise-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>So far we’ve mostly worked with the Grand Mesa region. Can you spatially subset the data to inspect the LIS-SnowModel estimates for the Front Range? What about for Senator Beck basin? Try to use hvplot to plot a map of SWE values for February 2020.</p><h3 id="exercise-2" class="relative group"><span class="heading-text">Exercise 2</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#exercise-2" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Here we focused on water year 2020. Can you select a point (maybe the same Park Reservoir SNOTEL point we worked with here) and make a multi-year time series?</p><h3 id="exercise-3-for-an-extra-challenge" class="relative group"><span class="heading-text">Exercise 3 (for an extra challenge!)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#exercise-3-for-an-extra-challenge" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>We learned about the SnowEx database in a tutorial earlier this week. Can you create a new notebook for combining the model output with your choice of field observation available in the database? Does the model over or underestimate the SnowEx observation?</p></div><div id="CrKIoxDh3s" class="relative group/block"><h2 id="conclusion" class="relative group"><span class="heading-text">Conclusion</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#conclusion" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>We’re now more familiar with model output and how to interact with it in Python. The code in this notebook is a great jumping off point for developing more advanced comparisons and interactive widgets.</p><p>The Python code can be adapted to other LIS simulations and to other model output as well, with minor modifications. Anyone interested in testing your new skills can combine what you learned here with the other SnowEx Hackweek tutorials - try comparing the LIS-SnowModel output with other snow observations collected during the 2017 field campaign!</p><p>For more information on <a target="_blank" rel="noreferrer" href="https://lis.gsfc.nasa.gov/" class="">NASA’s Land Information System</a> please see the links below</p></div><div id="WDfFkn1xTe" class="relative group/block"><h3 id="resources" class="relative group"><span class="heading-text">Resources</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#resources" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p><strong>Links</strong></p><ul><li><p><a target="_blank" rel="noreferrer" href="https://lis.gsfc.nasa.gov/" class="">LIS Website</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://github.com/NASA-LIS/LISF" class="">LIS on GitHub</a></p></li><li><p><a href="https://github.com/NASA-LIS/LISF/blob/master/docs/" class="italic" target="_blank" rel="noreferrer" data-state="closed">LIS Documentation</a></p></li><li><p><a target="_blank" rel="noreferrer" href="https://github.com/bmcandr/lis-public-tc-walkthrough" class="">LIS Test Case Walkthrough</a></p></li></ul><p><strong>References</strong></p><ul><li><p>Kumar, S.V., C.D. Peters-Lidard, Y. Tian, P.R. Houser, J. Geiger, S. Olden, L. Lighty, J.L. Eastman, B. Doty, P. Dirmeyer, J. Adams, K. Mitchell, E. F. Wood, and J. Sheffield, 2006: Land Information System - An interoperable framework for high resolution land surface modeling. Environ. Modeling &amp; Software, 21, 1402-1415, <cite class="" data-state="closed"><a href="https://doi.org/10.1016/j.envsoft.2005.07.004" target="_blank" rel="noreferrer" class="hover-link">KUMAR <em>et al.</em> (2006)</a></cite></p></li><li><p>Peters-Lidard, C.D., P.R. Houser, Y. Tian, S.V. Kumar, J. Geiger, S. Olden, L. Lighty, B. Doty, P. Dirmeyer, J. Adams, K. Mitchell, E.F. Wood, and J. Sheffield, 2007: High-performance Earth system modeling with NASA/GSFC’s Land Information System. Innovations in Systems and Software Engineering, 3(3), 157-165, <cite class="" data-state="closed"><a href="https://doi.org/10.1007/s11334-007-0028-x" target="_blank" rel="noreferrer" class="hover-link">Peters-Lidard <em>et al.</em> (2007)</a></cite></p></li></ul><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-text" style="white-space:pre"></code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Liston_2006">Liston, G. E., & Elder, K. (2006). A Distributed Snow-Evolution Modeling System (SnowModel). <i>Journal of Hydrometeorology</i>, <i>7</i>(6), 1259–1276. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1175/jhm548.1">10.1175/jhm548.1</a></li><li class="break-words" id="cite-KUMAR_2006">KUMAR, S., PETERSLIDARD, C., TIAN, Y., HOUSER, P., GEIGER, J., OLDEN, S., LIGHTY, L., EASTMAN, J., DOTY, B., & DIRMEYER, P. (2006). Land information system: An interoperable framework for high resolution land surface modeling. <i>Environmental Modelling &amp; Software</i>, <i>21</i>(10), 1402–1415. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1016/j.envsoft.2005.07.004">10.1016/j.envsoft.2005.07.004</a></li><li class="break-words" id="cite-Peters_Lidard_2007">Peters-Lidard, C. D., Houser, P. R., Tian, Y., Kumar, S. V., Geiger, J., Olden, S., Lighty, L., Doty, B., Dirmeyer, P., Adams, J., Mitchell, K., Wood, E. F., & Sheffield, J. (2007). High-performance Earth system modeling with NASA/GSFC’s Land Information System. <i>Innovations in Systems and Software Engineering</i>, <i>3</i>(3), 157–165. <a target="_blank" rel="noreferrer" href="https://doi.org/10.1007/s11334-007-0028-x">10.1007/s11334-007-0028-x</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/snow-cookbook/_preview/28/notebooks/pytorch-tutorial"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Analysis and Machine Learning</div>Neural Networks with PyTorch</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/snow-cookbook/_preview/28/notebooks/ucla-data-access"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Analysis and Machine Learning</div>Reanalysis Data Access</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/snow-cookbook/_preview/28/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/notebooks/snowmodeling-tutorial-pt1","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.3","options":{"favicon":"/snow-cookbook/_preview/28/build/config-item-9b3afca6-e94e9017f73b120589f022b282c6387f.ico","logo":"/snow-cookbook/_preview/28/build/config-item-24692dda-fb588f958fcb4ad5b7e368bf0fa823d9.svg","logo_dark":"/snow-cookbook/_preview/28/build/config-item-84d6d338-7eb6fc113a7f04273c7e9e629fc08d74.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Snow Cookbook","authors":[{"nameParsed":{"literal":"The SnowPit Community","given":"The SnowPit","family":"Community"},"name":"The SnowPit Community","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/SnowEx/snow-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/snowex_data_overview.ipynb"},{"file":"notebooks/earthaccess_snowex.ipynb"},{"file":"notebooks/snowex_database.ipynb"}],"title":"Data Access"},{"children":[{"file":"notebooks/GPR_Lidar_HackweekTutorial.ipynb"},{"file":"notebooks/thermal-ir-tutorial-pt1.ipynb"},{"file":"notebooks/timelapse-camera-tutorial.ipynb"},{"file":"notebooks/uavsar_accessing_imagery_pt1.ipynb"},{"file":"notebooks/microstructure-tutorial.ipynb"},{"file":"notebooks/aviris-ng-data.ipynb"},{"file":"notebooks/tls_data_access.ipynb"},{"file":"notebooks/is2_snow_depth_workflow.ipynb"},{"file":"notebooks/snotel_data_access.ipynb"},{"file":"notebooks/snow-pit_data_access.ipynb"}],"title":"Observations"},{"children":[{"file":"notebooks/pytorch_tutorial.ipynb"},{"file":"notebooks/snowmodeling_tutorial_pt1.ipynb"},{"file":"notebooks/UCLA_data_access.ipynb"},{"file":"notebooks/merra2_data_access.ipynb"},{"file":"notebooks/era5_data_access.ipynb"}],"title":"Analysis and Machine Learning"}],"thumbnail":"/snow-cookbook/_preview/28/build/3a5b2698b5d21d107a57901ba13beff9.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Data Access"},{"slug":"notebooks.snowex-data-overview","title":"Field Campaigns Overview","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/01_banner-d9b3e57eb42070adace4f392118daba6.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snowex-database","title":"SnowExSQL Database","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/data_examples-c054d6cf607965e4ac0a89d3db9802bd.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Observations"},{"slug":"notebooks.gpr-lidar-hackweektutorial","title":"GPR and Lidar","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/HackweekGraphicalAbs-bb405b95695bbee28952e1f4b4e49291.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.timelapse-camera-tutorial","title":"Time-lapse Cameras","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/timelapse-camera-tut-b5bfa4932edd6cc12e4e2967e9236138.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.uavsar-accessing-imagery-pt1","title":"UAVSAR","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/sthelens-3c4772d95993048f6f301a5d5bc55f96.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.microstructure-tutorial","title":"Microstructure","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/dozier2009_fig2-df1e2c8b238833f3221eb53163d3ca2d.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.aviris-ng-data","title":"AVIRIS-NG","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/2f77469a46f5527021926e2a430aabc5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.tls-data-access","title":"Terrestrial Laser Scanning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.is2-snow-depth-workflow","title":"Snow Depth Estimates with ICESat-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snotel-data-access","title":"SNOTEL Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snow-pit-data-access","title":"Snow Pit Data Access and SWE Calculation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Analysis and Machine Learning"},{"slug":"notebooks.pytorch-tutorial","title":"Neural Networks with PyTorch","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snowmodeling-tutorial-pt1","title":"Snow Modeling","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.ucla-data-access","title":"Reanalysis Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.merra2-data-access","title":"MERRA-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.era5-data-access","title":"ERA5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/snow-cookbook/_preview/28"},"routes/$":{"config":{"version":2,"myst":"1.6.3","options":{"favicon":"/snow-cookbook/_preview/28/build/config-item-9b3afca6-e94e9017f73b120589f022b282c6387f.ico","logo":"/snow-cookbook/_preview/28/build/config-item-24692dda-fb588f958fcb4ad5b7e368bf0fa823d9.svg","logo_dark":"/snow-cookbook/_preview/28/build/config-item-84d6d338-7eb6fc113a7f04273c7e9e629fc08d74.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Snow Cookbook","authors":[{"nameParsed":{"literal":"The SnowPit Community","given":"The SnowPit","family":"Community"},"name":"The SnowPit Community","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/SnowEx/snow-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/snowex_data_overview.ipynb"},{"file":"notebooks/earthaccess_snowex.ipynb"},{"file":"notebooks/snowex_database.ipynb"}],"title":"Data Access"},{"children":[{"file":"notebooks/GPR_Lidar_HackweekTutorial.ipynb"},{"file":"notebooks/thermal-ir-tutorial-pt1.ipynb"},{"file":"notebooks/timelapse-camera-tutorial.ipynb"},{"file":"notebooks/uavsar_accessing_imagery_pt1.ipynb"},{"file":"notebooks/microstructure-tutorial.ipynb"},{"file":"notebooks/aviris-ng-data.ipynb"},{"file":"notebooks/tls_data_access.ipynb"},{"file":"notebooks/is2_snow_depth_workflow.ipynb"},{"file":"notebooks/snotel_data_access.ipynb"},{"file":"notebooks/snow-pit_data_access.ipynb"}],"title":"Observations"},{"children":[{"file":"notebooks/pytorch_tutorial.ipynb"},{"file":"notebooks/snowmodeling_tutorial_pt1.ipynb"},{"file":"notebooks/UCLA_data_access.ipynb"},{"file":"notebooks/merra2_data_access.ipynb"},{"file":"notebooks/era5_data_access.ipynb"}],"title":"Analysis and Machine Learning"}],"thumbnail":"/snow-cookbook/_preview/28/build/3a5b2698b5d21d107a57901ba13beff9.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Data Access"},{"slug":"notebooks.snowex-data-overview","title":"Field Campaigns Overview","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/01_banner-d9b3e57eb42070adace4f392118daba6.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snowex-database","title":"SnowExSQL Database","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/data_examples-c054d6cf607965e4ac0a89d3db9802bd.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Observations"},{"slug":"notebooks.gpr-lidar-hackweektutorial","title":"GPR and Lidar","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/HackweekGraphicalAbs-bb405b95695bbee28952e1f4b4e49291.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.timelapse-camera-tutorial","title":"Time-lapse Cameras","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/timelapse-camera-tut-b5bfa4932edd6cc12e4e2967e9236138.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.uavsar-accessing-imagery-pt1","title":"UAVSAR","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/sthelens-3c4772d95993048f6f301a5d5bc55f96.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.microstructure-tutorial","title":"Microstructure","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/dozier2009_fig2-df1e2c8b238833f3221eb53163d3ca2d.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.aviris-ng-data","title":"AVIRIS-NG","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/2f77469a46f5527021926e2a430aabc5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.tls-data-access","title":"Terrestrial Laser Scanning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.is2-snow-depth-workflow","title":"Snow Depth Estimates with ICESat-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snotel-data-access","title":"SNOTEL Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snow-pit-data-access","title":"Snow Pit Data Access and SWE Calculation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Analysis and Machine Learning"},{"slug":"notebooks.pytorch-tutorial","title":"Neural Networks with PyTorch","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snowmodeling-tutorial-pt1","title":"Snow Modeling","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.ucla-data-access","title":"Reanalysis Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.merra2-data-access","title":"MERRA-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.era5-data-access","title":"ERA5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":2,"kind":"Notebook","sha256":"0bbdc00748e2c29c5faec21c211f6091bac503db2f741ce30fddb971fd1b9458","slug":"notebooks.snowmodeling-tutorial-pt1","location":"/notebooks/snowmodeling_tutorial_pt1.ipynb","dependencies":[],"frontmatter":{"title":"Snow Modeling","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"The SnowPit Community","given":"The SnowPit","family":"Community"},"name":"The SnowPit Community","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/SnowEx/snow-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/SnowEx/snow-cookbook/blob/HEAD/notebooks/snowmodeling_tutorial_pt1.ipynb","edit_url":"https://github.com/SnowEx/snow-cookbook/edit/HEAD/notebooks/snowmodeling_tutorial_pt1.ipynb","thumbnail":"/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png","exports":[{"format":"ipynb","filename":"snowmodeling_tutorial_pt1.ipynb","url":"/snow-cookbook/_preview/28/build/snowmodeling_tutoria-ec5541d7bdd0e294cecfddc2374dbc45.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Contributors:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i2Ak9YmCkB"}],"key":"Inl5op4Zo9"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gpxjjdm7AZ"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Melissa Wrzesien","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N0bfkR3QzA"},{"type":"superscript","children":[{"type":"text","value":"1,2","key":"nzNELYNGBG"}],"key":"yJfrSUomdr"},{"type":"text","value":", Brendan McAndrew","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cgcDZO1eKl"},{"type":"superscript","children":[{"type":"text","value":"1,3","key":"lUmzupl2Sh"}],"key":"BRZMLVoBOd"},{"type":"text","value":", Jian Li","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wqjuwe2LkD"},{"type":"superscript","children":[{"type":"text","value":"4,5","key":"VHCyKETkS3"}],"key":"Wl2hLdaid5"},{"type":"text","value":", Caleb Spradlin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zWZoIZRvG9"},{"type":"superscript","children":[{"type":"text","value":"4,6","key":"aQzVQojxor"}],"key":"jTkEbLetcF"}],"key":"LJxBlOmEWd"}],"key":"HoiRzC7zEC"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"superscript","children":[{"type":"text","value":"1","key":"EJMxBtrT1Y"}],"key":"JnGMkLf9do"},{"type":"text","value":" Hydrological Sciences Lab, NASA Goddard Space Flight Center, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EriwOxBur5"},{"type":"superscript","children":[{"type":"text","value":"2","key":"bldMiOrFjV"}],"key":"vDbStyMK8H"},{"type":"text","value":" University of Maryland, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VvosBLobyE"},{"type":"superscript","children":[{"type":"text","value":"3","key":"aXDdIq2il3"}],"key":"YKla7h93WO"},{"type":"text","value":" Science Systems and Applications, Inc., ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"awD3PJImr0"},{"type":"superscript","children":[{"type":"text","value":"4","key":"agSXZIB2fG"}],"key":"cLd85O44Ux"},{"type":"text","value":" InuTeq, LLC, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gRA5MGpE2s"},{"type":"superscript","children":[{"type":"text","value":"5","key":"wfCbcyCr0T"}],"key":"uErMVgsjXX"},{"type":"text","value":" Computational and Information Sciences and Technology Office (CISTO), NASA Goddard Space Flight Center, ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o61gok8eaq"},{"type":"superscript","children":[{"type":"text","value":"6","key":"NS9nfbFmOv"}],"key":"NHCfyltlrp"},{"type":"text","value":" High Performance Computing, NASA Goddard Space Flight Center","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SlQdKBGwSD"}],"key":"lTWGvqFzyT"}],"key":"M4Ec08uTJO"}],"key":"x5HOUAlj3h"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zQNspQZxkh"}],"key":"vl0p3iNKrd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Learn about the role of modeling in a satellite mission","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Vx0Nqj7YS6"}],"key":"AxqKZO3oeM"}],"key":"GZD92AlPBH"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Open, explore, and visualize gridded model output","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WoGQCVMAgh"}],"key":"W5d8uRmboF"}],"key":"DJN3lGz4hJ"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compare model output to raster- and point-based observation datasets","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"HLI10gXzLn"}],"key":"GA0BiMhmnt"}],"key":"AKQJxBHoZu"}],"key":"AILuUSgj9I"}],"key":"GqVrZlZLjg"}],"key":"FsbQzSzKxt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The goal of a future snow satellite is to provide improved understanding of global snow mass, as compared to current estimates. However, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FJAMOGgPGb"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"a single sensor likely won’t be able to accurately observe all types of snow in all conditions for the entire globe","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zFBEUBa0ov"}],"key":"FFDQ0cBgqd"},{"type":"text","value":". Instead, we need to combine future snow observations with other tools - including models and observations from currently available satellites.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zt7qr8SiVa"}],"key":"kaB0tFrDz6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Models can also help to extend snow observations to areas where observations are not available. Data may be missing due to orbit gaps or masked out in regions of higher uncertainty. Remote sensing observations and models can be combined through ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ea9EQTPTSK"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"data assimilation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hT42N5AvDl"}],"key":"KtmqpkUiq1"},{"type":"text","value":", a process where observations are used to constrain model estimates.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FiPihjIDOU"}],"key":"dBYoPHpLlB"},{"type":"image","url":"/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WuVBQd0Hs9","urlSource":"./images/modeling/DAflowchart_v4.png"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The figure above shows a conceptual example of how satellite observations with orbit gaps could be combined with a model to produce results with no missing data. (Figure modified from diagram provided by Eunsang Cho)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OWurFB5p5W"}],"key":"aYSoSDyMeF"}],"key":"uzDLrnP2vj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What is LIS?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NlTKoliv34"}],"identifier":"what-is-lis","label":"What is LIS?","html_id":"what-is-lis","implicit":true,"key":"qE1tqaJi31"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Since models will likely play a role in processing observations from a snow satellite mission, it is important to become comfortable working with gridded data products. Today we will use sample model output from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lYE0qMLPgS"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"NASA’s Land Information System (LIS)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Pbez8ww3PJ"}],"key":"nSz6PdtABs"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kH6d1zfQ8t"}],"key":"GsSD7bHSiG"},{"type":"blockquote","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The Land Information System is a software framework for land surface modeling and data assimilation developed with the goal of integrating satellite and ground-based observational data products with advanced modeling techniques to produce estimates of land surface states and fluxes.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uhHJB2SsVF"}],"key":"LLNCrcptlA"}],"key":"RDPa2Bodd7"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"TL;DR","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"voI9hw68Pm"}],"key":"KGrNfqQr7T"},{"type":"text","value":" LIS = land surface models + data assimilation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BWrDwIkTZV"}],"key":"RPzkO7iB4C"},{"type":"image","url":"/snow-cookbook/_preview/28/build/LIS_schematic-58f4b7dbdf1980fef5db8ae60a513e5c.png","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"nCXMsIiQDK","urlSource":"./images/modeling/LIS_schematic.png"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"One key feature LIS provides is flexibility to meet user needs. LIS consists of a collection of plug-ins, or modules, that allow users to design simulations with their choice of land surface model, meteorological forcing, data assimilation, hydrological routing, land surface parameters, and more. The plug-in based design also provides extensibility, making it easier to add new functionality to the LIS framework.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FxuYDcq21V"}],"key":"htJIyI0U1d"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Current efforts to expand support for snow modeling include implementation of snow modules, such as ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dUPaZNGImb"},{"type":"cite","url":"https://doi.org/10.1175/JHM548.1","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"SnowModel","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HXOUjq7Hfp"}],"kind":"narrative","label":"Liston_2006","identifier":"https://doi.org/10.1175/JHM548.1","enumerator":"1","key":"xnFY98wD71"},{"type":"text","value":" and ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lbvSEOn982"},{"type":"link","url":"http://www.umr-cnrm.fr/spip.php?article265\u0026lang=en","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Crocus","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"vk277b8Fmo"}],"urlSource":"http://www.umr-cnrm.fr/spip.php?article265\u0026lang=en","key":"pEQdb2omEh"},{"type":"text","value":", into the LIS framework. These models, when run at the scale of ~100 meters, will enable simulation of wind redistribution, snow grain size, and other important processes for more accurate snow modeling.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xVIfBn2WSM"}],"key":"qIE77eEaqa"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Development of LIS is led by the ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"PvnbweEsAG"},{"type":"link","url":"https://earth.gsfc.nasa.gov/hydro","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Hydrological Sciences Laboratory","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"j4nHixVnhg"}],"urlSource":"https://earth.gsfc.nasa.gov/hydro","key":"M2AYTaOPqU"},{"type":"text","value":" at ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"uz3iJWYzu1"},{"type":"link","url":"https://www.nasa.gov/goddard","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"NASA’s Goddard Space Flight Center","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"CBe40NpFzU"}],"urlSource":"https://www.nasa.gov/goddard","key":"yBj9M5iWPV"},{"type":"text","value":". (Figure above provided by the LIS team)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"aZxV6d8p5Q"}],"key":"dugakqgUln"}],"key":"dOWElXnlbs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Working with Modeled Output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v7pAaYQHpf"}],"identifier":"working-with-modeled-output","label":"Working with Modeled Output","html_id":"working-with-modeled-output","implicit":true,"key":"DoyQTjguki"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we will use sample model output from a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VIvfDheOEa"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"LIS-SnowModel","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XR2eLZlpLI"}],"key":"Nrf1R8lvMF"},{"type":"text","value":" simulation over a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aW9z4L7Vpb"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"western Colorado domain","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rl9NnT0MxT"}],"key":"EZ2cLmRJQZ"},{"type":"text","value":". Daily estimates of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p7slETJqAg"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"SWE, snow depth, and snow density","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"itCAxNvYeD"}],"key":"a4B8F7l4RB"},{"type":"text","value":" are written to output. The SnowModel simulation has a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lCmP6MUfY6"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"spatial resolution of 100 m","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xZDEpojZrC"}],"key":"qWQaE7KnfW"},{"type":"text","value":". We’ve provided four years of output, though here we’ll mostly use output from water year 2020.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yeBzVGdwBg"}],"key":"XJejjKcp3S"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Below, we’ll walk through how to open and interact with the LIS-SnowModel output. Our main objectives are to demonstrate how to do the following with a gridded dataset like LIS-SnowModel:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"J0o5ZY6yXW"}],"key":"YH4IQByQhE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Understand attributes of model data file and available variables","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"cX4l9AFRfD"}],"key":"A3NoPQr2x5"}],"key":"nved4QYl4l"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a spatial map of model output","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"DheBO7W6gR"}],"key":"ZpgqkmwGCi"}],"key":"qjQh4Ty53K"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create time series at a point and averaged across domain","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wI1W5PoERB"}],"key":"AtdYxCDrS7"}],"key":"lU0XAvGoDi"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compare LIS-SnowModel to raster and point data","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fRqCh2a3vr"}],"key":"fgVMuVOGjT"}],"key":"LFk5r109lh"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a visualization for quick evaluation of model estimates","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"tC2zjuEXyf"}],"key":"zNQlsNH0EM"}],"key":"hs452WwisB"}],"key":"xYSTjYFG11"}],"key":"ndAMpI6dz0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XdpwTDONOl"}],"identifier":"import-libraries","label":"Import Libraries","html_id":"import-libraries","implicit":true,"key":"MAZdaUFbkC"}],"key":"hzyQX93gxS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# interface to Amazon S3 filesystem\nimport s3fs\n\n# interact with n-d arrays\nimport numpy as np\nimport xarray as xr\n\n# interact with tabular data (incl. spatial)\nimport pandas as pd\nimport geopandas as gpd\n\n# interactive plots\nimport holoviews as hv\nimport geoviews as gv\nimport hvplot.pandas\nimport hvplot.xarray\n# set bokeh as the holoviews plotting backend\n#hv.extension('bokeh')\n# set holoviews backend to Bokeh\n#gv.extension('bokeh')\n\n# used to find nearest grid cell to a given location\nfrom scipy.spatial import distance\n\nimport fsspec\nfrom datetime import datetime as dt\n\nfrom geoviews import opts\nfrom geoviews import tile_sources as gvts\nfrom datashader.colors import viridis\nimport datashader\nfrom holoviews.operation.datashader import datashade, shade, dynspread, spread, rasterize\nfrom holoviews.streams import Selection1D, Params\nimport panel as pn\nimport param as pm\nimport warnings\nimport holoviews.operation.datashader as hd\nwarnings.filterwarnings(\"ignore\")\n\npn.extension()\npn.param.ParamMethod.loading_indicator =True","key":"ImdlHAlLHl"},{"type":"output","id":"Sj0PP9gYKEiY6ho2VKood","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[1]\u001b[39m\u001b[32m, line 2\u001b[39m\n\u001b[32m      1\u001b[39m \u001b[38;5;66;03m# interface to Amazon S3 filesystem\u001b[39;00m\n\u001b[32m----\u003e \u001b[39m\u001b[32m2\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01ms3fs\u001b[39;00m\n\u001b[32m      4\u001b[39m \u001b[38;5;66;03m# interact with n-d arrays\u001b[39;00m\n\u001b[32m      5\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnumpy\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnp\u001b[39;00m\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 's3fs'","ename":"ModuleNotFoundError","evalue":"No module named 's3fs'"}],"key":"zHUhhrgp7n"}],"key":"WVznOrtNlJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the LIS-SnowModel Output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ztifKDy8Cp"}],"identifier":"load-the-lis-snowmodel-output","label":"Load the LIS-SnowModel Output","html_id":"load-the-lis-snowmodel-output","implicit":true,"key":"H3DXAb39uV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pP2Es1Nwu8"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ey0hLfogZy"},{"type":"text","value":" library makes working with labelled n-dimensional arrays easy and efficient. If you’re familiar with the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IMXnf0bTVE"},{"type":"inlineCode","value":"pandas","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KgV7M4uHDS"},{"type":"text","value":" library it should feel pretty familiar.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sa3FLXuekh"}],"key":"ZlR5UTs2Ay"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here we load the LIS-SnowModel output into an ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SlICahXaZD"},{"type":"inlineCode","value":"xarray.Dataset","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lJKABlb8wd"},{"type":"text","value":" object:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ra1wfx0gED"}],"key":"OkPlYiRRnF"}],"key":"FAPKBHY03V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# create S3 filesystem object\ns3 = s3fs.S3FileSystem(anon=False)\n\n# define the name of our S3 bucket\nbucket_name = 'eis-dh-hydro/SNOWEX-HACKWEEK'\n\n# define path to store on S3\nlis_output_s3_path_time_chunk = f's3://{bucket_name}/2022/ZARR/SURFACEMODEL/LIS_HIST_rechunkedV4.d01.zarr'\nlis_output_s3_path = f's3://{bucket_name}/2022/ZARR/SURFACEMODEL/LIS_HIST_default_chunks.d01.zarr/'\n\n# create key-value mapper for S3 object (required to read data stored on S3)\nlis_output_mapper = s3.get_mapper(lis_output_s3_path)\nlis_output_mapper_tc = s3.get_mapper(lis_output_s3_path_time_chunk)\n\n# open the dataset\nlis_output_ds = xr.open_zarr(lis_output_mapper, consolidated=True)\nlis_output_ds_tc = xr.open_zarr(lis_output_mapper_tc, consolidated=True)","key":"DVZPeEPHfH"},{"type":"output","id":"ZxeCiF1XVFCDIoOCpjK9I","data":[],"key":"vh7t105vsn"}],"key":"yMqc41WiG5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Explore the Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hbpTiw6h5I"}],"identifier":"explore-the-data","label":"Explore the Data","html_id":"explore-the-data","implicit":true,"key":"BpcN1S9h38"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Display an interactive widget for inspecting the dataset by running a cell containing the variable name. Expand the dropdown menus and click on the document and database icons to inspect the variables and attributes.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fLLqtkteDw"}],"key":"kldx7DkK53"}],"key":"RjxCS5Ikt8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lis_output_ds","key":"ywJieyoemZ"},{"type":"output","id":"iYPFZxjCw2YMMeWtTXpsE","data":[],"key":"SYpbfSnwU3"}],"key":"qjqcDHbnc3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Accessing Attributes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ujWQcyHfgp"}],"identifier":"accessing-attributes","label":"Accessing Attributes","html_id":"accessing-attributes","implicit":true,"key":"QFSl1rP16D"}],"key":"k3C86WsTSY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dataset attributes (metadata) are accessible via the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mDmQfWHWkB"},{"type":"inlineCode","value":"attrs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uSgNsT24eT"},{"type":"text","value":" attribute:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SXUFB2ysqT"}],"key":"fdQEwsIAsF"}],"key":"lZCjsuWVZH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lis_output_ds.attrs","key":"knf28rPVNI"},{"type":"output","id":"FvVG-K8L6HqiBqFrHqlNd","data":[],"key":"qydoPjFZQl"}],"key":"zdUQ0efkGC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Accessing Variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zwgWmHjz2F"}],"identifier":"accessing-variables","label":"Accessing Variables","html_id":"accessing-variables","implicit":true,"key":"lfUujE9ViT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Variables can be accessed using either ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LW1BDTgrsa"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dot notation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BdYuWXmhO3"}],"key":"uUDw287aS7"},{"type":"text","value":" or ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mJgu03hAmc"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"square bracket notation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EZALddTkqv"}],"key":"Y6qc3KFhov"},{"type":"text","value":". Here we will stick with square bracket notation:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nhxagi5f2I"}],"key":"TlMqOa5H5C"}],"key":"zLQr1Ysbc2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# square bracket notation\nlis_output_ds['SM_SnowDepth_inst']","key":"Uqfjd7vgyy"},{"type":"output","id":"x71IOZODjN4FrENmIRaD7","data":[],"key":"MyITaXfqSo"}],"key":"ek8cWuUXQ1"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Watch out for large datasets!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pB2A16eC6A"}],"key":"n6uk9bbe1v"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Note that the 4-ish years of model output (1694 daily time steps for a domain of size 6650 x 4800) has a size of over ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"F6Bwn2r8q4"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"200 gb","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"C83ErplK2T"}],"key":"u6J7SJ5HOq"},{"type":"text","value":"! As we’ll see below, this is just for an area over western Colorado. If we’re interested in modeling the western United States or CONUS or even global at high resolution, we need to be prepared to work with some large datasets.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"W0LruPXCD6"}],"key":"Hs7mXi3zQS"}],"key":"E18xMvbw67"}],"key":"vT6YFx9DPB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dimensions and Coordinate Variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AdpB6P1DFB"}],"identifier":"dimensions-and-coordinate-variables","label":"Dimensions and Coordinate Variables","html_id":"dimensions-and-coordinate-variables","implicit":true,"key":"teZTxjgNbe"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The dimensions and coordinate variable fields put the “","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zuE3CbOKIx"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"labelled","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u3dQopwhBV"}],"key":"nbV9KDtH69"},{"type":"text","value":"” in “labelled n-dimensional arrays”:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YwH0wEE40W"}],"key":"gJymEArGxg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dimensions:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"e9nirMgLZd"}],"key":"QmeEDd8ms9"},{"type":"text","value":" labels for each dimension in the dataset (e.g., ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OJnoyYn5Hg"},{"type":"inlineCode","value":"time","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iNQLbB5aGs"},{"type":"text","value":")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"o5F9XoNhSt"}],"key":"AlqVENxKcy"}],"key":"zA7k7P1Xvo"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Coordinates:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Xq77gWpMIM"}],"key":"GHeZ0bVPKc"},{"type":"text","value":" labels for indexing along dimensions (e.g., ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"M1AqDepF9y"},{"type":"inlineCode","value":"'2020-01-01'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rQkq6gSMR4"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"TZzxrH5x9Z"}],"key":"R6oTCoOScl"}],"key":"GWGB974Z0g"}],"key":"Yth3q2ztce"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We can use these labels to select, slice, and aggregate the dataset.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ztTJsqjcEN"}],"key":"tsplb1x2ta"}],"key":"HlSYEkFmlg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Subsetting in Space or Time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V469mD0PnN"}],"identifier":"subsetting-in-space-or-time","label":"Subsetting in Space or Time","html_id":"subsetting-in-space-or-time","implicit":true,"key":"ex9S40heoc"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"xarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KNE9Iyyeen"},{"type":"text","value":" provides two methods for selecting or subsetting along coordinate variables:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UjKr4xq0iX"}],"key":"qFYpXAN7kE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"index selection: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IkEvPyj42N"},{"type":"inlineCode","value":"ds.isel(time=0)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kOttaeW7KG"}],"key":"cX2hxdHNFG"}],"key":"uOwxOh5HQe"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"value selection ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"iVm708Y5dJ"},{"type":"inlineCode","value":"ds.sel(time='2020-01-01')","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AiFcZ6Nqb4"}],"key":"E0WKn4XoHT"}],"key":"t1BkZZ7zfJ"}],"key":"lkft9eOX6W"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"For example, we can use value selection to select based on the the coorindates of a given dimension:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"hBM4gj3xqD"}],"key":"L053cHAxqu"}],"key":"EWR2pgm0Ai"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lis_output_ds.sel(time='2020-01-01')","key":"q93T6QwRHP"},{"type":"output","id":"C5HqQz7N6ni1kWhWaNWAt","data":[],"key":"DpQtL3Xxn9"}],"key":"PTXqixZbl3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fbxSQvbkNj"},{"type":"inlineCode","value":".sel()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lNjehgJjfr"},{"type":"text","value":" approach also allows the use of shortcuts in some cases. For example, here we select all timesteps in the month of January 2020. Note that length of the time dimension is now only 31.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dd4hqE5ruW"}],"key":"D6ADkgZdB0"}],"key":"OMXnKyYPOY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lis_output_ds.sel(time='2020-01')","key":"d2DXhKmb7S"},{"type":"output","id":"MSTdsji91ioSv_TcNsmdp","data":[],"key":"R7Up1KABPd"}],"key":"cD3C8ssi0Z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Latitude and Longitude","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lPLlZnez1f"}],"identifier":"latitude-and-longitude","label":"Latitude and Longitude","html_id":"latitude-and-longitude","implicit":true,"key":"q97qZsEXIa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You may have noticed that latitude (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E6xkAuM2Vu"},{"type":"inlineCode","value":"lat","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"veNzDReTC3"},{"type":"text","value":") and longitude (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hPD7z7K6C2"},{"type":"inlineCode","value":"lon","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oGBfOdpKKd"},{"type":"text","value":") are not listed as dimensions. This dataset would be easier to work with if ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a9sinKcNqQ"},{"type":"inlineCode","value":"lat","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ODetK6h0rN"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Yi2m3Wn70O"},{"type":"inlineCode","value":"lon","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VEH2lP4N8k"},{"type":"text","value":" were coordinate variables and dimensions. Here we define a helper function that reads the spatial information from the dataset attributes, generates arrays containing the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"woseDBdUgU"},{"type":"inlineCode","value":"lat","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C0os3uJtwi"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kzMc5kgnDG"},{"type":"inlineCode","value":"lon","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J7U6SOyxS1"},{"type":"text","value":" values, and appends them to the dataset:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TZRirI59Yy"}],"key":"HdsarSxr74"}],"key":"WTpYTFxH7U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def add_latlon_coords(dataset: xr.Dataset)-\u003exr.Dataset:\n    \"\"\"Adds lat/lon as dimensions and coordinates to an xarray.Dataset object.\"\"\"\n    \n    # get attributes from dataset\n    attrs = dataset.attrs\n    \n    # get x, y resolutions\n    dx = .001 #round(float(attrs['DX']), 3)\n    dy = .001 #round(float(attrs['DY']), 3)\n       \n    # get grid cells in x, y dimensions\n    ew_len = len(dataset['east_west'])\n    ns_len = len(dataset['north_south'])\n    \n    # get lower-left lat and lon\n    ll_lat = round(float(attrs['SOUTH_WEST_CORNER_LAT']), 3)\n    ll_lon = round(float(attrs['SOUTH_WEST_CORNER_LON']), 3)\n    \n    # calculate upper-right lat and lon\n    ur_lat =  41.5122 #ll_lat + (dy * ns_len)\n    ur_lon = -103.9831 #ll_lon + (dx * ew_len)\n    \n    # define the new coordinates\n    coords = {\n        # create an arrays containing the lat/lon at each gridcell\n        'lat': np.linspace(ll_lat, ur_lat, ns_len, dtype=np.float32, endpoint=False).round(4),\n        'lon': np.linspace(ll_lon, ur_lon, ew_len, dtype=np.float32, endpoint=False).round(4)\n    }\n    \n    lon_attrs = dataset.lon.attrs\n    lat_attrs = dataset.lat.attrs\n    \n    # rename the original lat and lon variables\n    dataset = dataset.rename({'lon':'orig_lon', 'lat':'orig_lat'})\n    # rename the grid dimensions to lat and lon\n    dataset = dataset.rename({'north_south': 'lat', 'east_west': 'lon'})\n    # assign the coords above as coordinates\n    dataset = dataset.assign_coords(coords)\n    dataset.lon.attrs = lon_attrs\n    dataset.lat.attrs = lat_attrs\n    \n    \n    return dataset","key":"iUkcNgezsY"},{"type":"output","id":"KMc2u4E_vaMIl4pHsvQ2W","data":[],"key":"ZoBDUwDJsj"}],"key":"FyxDDwhSxe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now that the function is defined, let’s use it to append ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nzEBBD3Xqq"},{"type":"inlineCode","value":"lat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K3jFjJftG0"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EOl8CXkoTS"},{"type":"inlineCode","value":"lon","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jl0Pc30lPg"},{"type":"text","value":" coordinates to the LIS output:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g9US1SQY8p"}],"key":"c9pvNkfIcB"}],"key":"Z1qFp283EL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lis_output_ds = add_latlon_coords(lis_output_ds)\nlis_output_ds_tc = add_latlon_coords(lis_output_ds_tc)","key":"iWf5hXnzxs"},{"type":"output","id":"9ajI_3ewsWV6TV8jeOkpa","data":[],"key":"R1c06ayOP6"}],"key":"FZx1XGXFqR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Inspect the dataset:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HigPX8XVb8"}],"key":"NTJI8TOHSm"}],"key":"sG5ELd68SX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lis_output_ds","key":"D0cpFSKHLI"},{"type":"output","id":"EBYbWr8gSrr7POpo8nM6I","data":[],"key":"xKtzjZXY6b"}],"key":"qXcBvYJ04j"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"asNS5q09kw"},{"type":"inlineCode","value":"lat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bfQwWVMSAF"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nydErxRcOb"},{"type":"inlineCode","value":"lon","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p0nfbFCc3Y"},{"type":"text","value":" are listed as coordinate variables and have replaced the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ilut7xmfBv"},{"type":"inlineCode","value":"north_south","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"no5QZMONcd"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sKuot5GKiT"},{"type":"inlineCode","value":"east_west","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BkDr9Pgm1L"},{"type":"text","value":" dimensions. This will make it easier to spatially subset the dataset!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lVzvyrRQ4Y"}],"key":"nhHEhtL3TC"}],"key":"QMF90bl2fj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Basic Spatial Subsetting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ubFFEjZ5HL"}],"identifier":"basic-spatial-subsetting","label":"Basic Spatial Subsetting","html_id":"basic-spatial-subsetting","implicit":true,"key":"uNXVwpBhEO"}],"key":"M9sytlQrRH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yh7i8rtvrU"},{"type":"inlineCode","value":"slice()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wU3bFTjcY9"},{"type":"text","value":" function on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rCq33fcqgw"},{"type":"inlineCode","value":"lat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XqtPc1XoKL"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qnjlGfjft2"},{"type":"inlineCode","value":"lon","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vaq6sz6JQA"},{"type":"text","value":" dimensions to select data between a range of latitudes and longitudes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RYtoBADEAL"}],"key":"ShCmtgq6hE"}],"key":"Fa8S2U7m7G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# uncomment line below to work with the full domain -\u003e this will be much slower!\n#lis_output_ds.sel(lat=slice(35.5, 41), lon=slice(-109, -104))\n\n# just Grand Mesa -\u003e smaller domain for faster run times\n# note the smaller lat/lon extents in the dimensions\nlis_output_ds.sel(lat=slice(38.6, 39.4), lon=slice(-108.6, -107.1))","key":"YgggGcsyzM"},{"type":"output","id":"zDvU1sfgC1z_AANfPhjjq","data":[],"key":"bbOPR8Awqv"}],"key":"iI9IQrH6cL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice how the sizes of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mVIeweqQU8"},{"type":"inlineCode","value":"lat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yUTwofFPVV"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GoOAoOGzM6"},{"type":"inlineCode","value":"lon","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H4LU0q7KTT"},{"type":"text","value":" dimensions have decreased.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C3WmOggPeo"}],"key":"UYV44dKWte"}],"key":"J4kvfph8g9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Subset Across Multiple Dimensions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TiA1pisYBB"}],"identifier":"subset-across-multiple-dimensions","label":"Subset Across Multiple Dimensions","html_id":"subset-across-multiple-dimensions","implicit":true,"key":"AgKYqdQNp3"}],"key":"FPX6L3JzlS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we will combine the above examples for subsetting both spatially and temporally:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kiv8FYWh6B"}],"key":"Hw1fzJdbKy"}],"key":"VNGW6iucfk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# define a range of dates to select\nwy_2020_slice = slice('2019-10-01', '2020-09-30')\n\n# define lat/lon for Grand Mesa area\nlat_slice = slice(38.6, 39.4)\nlon_slice = slice(-108.6, -107.1)\n\n# select the snow depth and subset to wy_2020_slice\nsnd_GM_wy2020_ds = lis_output_ds['SM_SnowDepth_inst'].sel(time=wy_2020_slice, lat=lat_slice, lon=lon_slice)\nsnd_GM_wy2020_ds_tc = lis_output_ds_tc['SM_SnowDepth_inst'].sel(time=wy_2020_slice, lat=lat_slice, lon=lon_slice)\n\n# inspect resulting dataset\nsnd_GM_wy2020_ds","key":"NujX0u6mfv"},{"type":"output","id":"FpublfN1XVTPI0xtVFKeE","data":[],"key":"WA2m5kW1Fa"}],"key":"jwQvRMoEDa"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Subset for more manageable sizes!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FnRsQnJS2T"}],"key":"w7ihEeWzzj"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We’ve now subsetted both spatially (down to just Grand Mesa domain) and temporally (water year 2020). Note the smaller size of the data array -\u003e ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"m7JF6DUB4I"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"a decrease from over 200 gb to 1.7 gb","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"C64jJKucpM"}],"key":"FNOQfH5pCU"},{"type":"text","value":"! This smaller dataset will be much easier to work with, but feel free to try some of the commands with the full dataset, just give it a few minutes to process!","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pE2sOVYje3"}],"key":"ERdtauCuiS"}],"key":"jOvmqYuLF3"}],"key":"rdu5nKwFKQ"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fu9zCLEs92"}],"identifier":"plotting","label":"Plotting","html_id":"plotting","implicit":true,"key":"qUmz3HlZGS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’ve imported two plotting libraries:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"X2O3dPkSMg"}],"key":"ez7EZCyu3k"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"A8ztpCsdcT"},{"type":"text","value":": static plots","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"r6ooY8yXBX"}],"key":"Mw9LedJSX3"}],"key":"LfFk8oK2UV"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"hvplot","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UdtSA8oQFp"},{"type":"text","value":": interactive plots","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"xi7uds5oBl"}],"key":"RpvTkQGnzS"}],"key":"VtKvD2M83S"}],"key":"TtqBPri5ez"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"We can make a quick ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"V2Dyx1sIwd"},{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kfN3E4Li1P"},{"type":"text","value":"-based plot for the subsetted data using the ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pFJd2htUaD"},{"type":"inlineCode","value":".plot()","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TWbUprwgPN"},{"type":"text","value":" function supplied by ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Dr3ryWjIZh"},{"type":"inlineCode","value":"xarray.Dataset","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"FuYOrtv4r8"},{"type":"text","value":" objects. For this example, we’ll select one day and plot it:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"D2au6aVNio"}],"key":"SbynNRpL43"}],"visibility":"show","key":"fKLvw7X3UV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# simple matplotlilb plot\nsnd_GM_wy2020_ds.sel(time='2020-01-01').plot();","key":"OFBzJMYINi"},{"type":"output","id":"affJoJvS8aQIftrHYYBHA","data":[],"key":"Hi7FLtJ8gI"}],"key":"IWKMnAWDEN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Similarly we can make an interactive plot using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RPEVDoHcJk"},{"type":"inlineCode","value":"hvplot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QkZp4Cnt5w"},{"type":"text","value":" accessor and specifying a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EEfs7owpEN"},{"type":"inlineCode","value":"quadmesh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qjSW4q9aiJ"},{"type":"text","value":" plot type:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QTAAyD38Ar"}],"key":"vFpAJUZl3Z"}],"key":"dPXL6q37i4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# hvplot based map\nsnd_GM_20200101_plot = snd_GM_wy2020_ds.sel(time='2020-01-01').hvplot.quadmesh(geo=True, rasterize=True, project=True,\n                                                                               xlabel='lon', ylabel='lat', cmap='viridis',\n                                                                               tiles='EsriImagery')\n\nsnd_GM_20200101_plot","key":"MLnyUUc7Eo"},{"type":"output","id":"KTu_K4Myz1ypIoV2jhS3-","data":[],"key":"JXykhAR1hx"}],"key":"VcTccbYDDC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Pan, zoom, and scroll around the map. Hover over the LIS-SnowModel data to see the data values.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j1Q3PBIWVd"}],"key":"zYUhnKWs7x"}],"key":"RiFYBo7qOS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we try to plot more than one time-step ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PAVB5C4oSi"},{"type":"inlineCode","value":"hvplot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xi8gNhwTwb"},{"type":"text","value":" will also provide a time-slider we can use to scrub back and forth in time:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QWU4YfMpos"}],"key":"PaL3BsUK73"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Note:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kueGsI5Xsc"}],"key":"gdeUytqOeP"},{"type":"text","value":" the time-slider below will only work running in Jupyter Lab (not on the snowex website)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q1QznRunvt"}],"key":"WqWsI9AvMx"}],"key":"s5RAbBX8Sf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"snd_GM_wy2020_ds.sel(time='2020-01').hvplot.quadmesh(geo=True, rasterize=True, project=True,\n                             xlabel='lon', ylabel='lat', cmap='viridis',\n                             tiles='EsriImagery')","key":"rgk2JlOjzF"},{"type":"output","id":"EJ5oTI1EK5f4D-T59zDmZ","data":[],"key":"KZQkhwWZhV"}],"key":"AgArKyvgeu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From here on out we will stick with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WWxOjgdUb9"},{"type":"inlineCode","value":"hvplot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Eh5VAUWpKf"},{"type":"text","value":" for plotting.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uFVq8GZHih"}],"key":"qWqs1oVlEN"}],"key":"jfLf0kl2iP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":5,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Timeseries Plots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rX1bEwsF2y"}],"identifier":"timeseries-plots","label":"Timeseries Plots","html_id":"timeseries-plots","implicit":true,"key":"kWUqQvlXn3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can generate a timeseries for a given grid cell by selecting and calling the plot function:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jJ9ETcRqNW"}],"key":"TPUcU2ydBo"}],"key":"MSbyzwA8kD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# define point to take timeseries (note: must be present in coordinates of dataset)\nts_lon, ts_lat = (-107.8702, 39.0504)\n\n# plot timeseries\nsnd_GM_wy2020_ds_tc.sel(lat=ts_lat, lon=ts_lon).hvplot.line(title=f'Snow Depth Timeseries @ Lon: {ts_lon}, Lat: {ts_lat}',\n                                                   xlabel='Date', ylabel='Snow Depth (m)') + \\\n    snd_GM_20200101_plot * gv.Points([(ts_lon, ts_lat)]).opts(size=10, color='red')\n    ","key":"nl5Z8juHCP"},{"type":"output","id":"W3ctZI6eh32l6t-jEG47b","data":[],"key":"sYQPtb5kSb"}],"key":"zvuSHL7Pw2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the next section we’ll learn how to create a timeseries over a broader area.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mMaYVsmEHu"}],"key":"VTgtEP6MLu"}],"key":"xZP91y9e3r"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Aggregation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fi4btjC4aj"}],"identifier":"aggregation","label":"Aggregation","html_id":"aggregation","implicit":true,"key":"rVq3wOkgbi"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We can perform aggregation operations on the dataset such as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"byR9h0bDhN"},{"type":"inlineCode","value":"min()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LdHXmKygTy"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zC90hkU8Yy"},{"type":"inlineCode","value":"max()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XG2j0fM3OP"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CkbUYGea3S"},{"type":"inlineCode","value":"mean()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HC7QuKPcKS"},{"type":"text","value":", and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EYAtnzURRe"},{"type":"inlineCode","value":"sum()","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sniOLijbRL"},{"type":"text","value":" by specifying the dimensions along which to perform the calculation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fsQ8c1aOo0"}],"key":"fAGk6sJuto"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"For example we can calculate the daily mean snow depth for the region around Grand Mesa for water year 2020:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"T55qOx8kDI"}],"key":"Vv8l0qPLvs"}],"key":"ZcVcYi1RE4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Area Average","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cbBa1qwUc8"}],"identifier":"area-average","label":"Area Average","html_id":"area-average","implicit":true,"key":"lwjEOJIBSi"}],"key":"eyk0vJMmYB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# take area-averaged mean at each timestep\nmean_snd_GM_wy2020_ds = snd_GM_wy2020_ds_tc.mean(['lat', 'lon'])\n\n# inspect the dataset\nmean_snd_GM_wy2020_ds","key":"TB5h8iXrV8"},{"type":"output","id":"100jJ2j_L_QDvh69oeL3Y","data":[],"key":"Oaeshf8Qbs"}],"key":"VcRCsojvk2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# plot timeseries (hvplot knows how to plot based on dataset's dimensionality!)\nmean_snd_GM_wy2020_ds.hvplot(title='Mean LIS-SnowModel Snow Depth for Grand Mesa area', xlabel='Date', ylabel='Snow Depth (m)')","key":"FRLM4qtNPA"},{"type":"output","id":"I4epBpuAntDuA8ZUpziEL","data":[],"key":"TCe6DoQVXz"}],"key":"Ih1hLR60Es"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Comparing Model Output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OhLpVhnbYU"}],"identifier":"comparing-model-output","label":"Comparing Model Output","html_id":"comparing-model-output","implicit":true,"key":"g4kt4kTtv8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that we’re familiar with the model output, let’s compare it to two other datasets: SNODAS (raster) and SNOTEL (point).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EZqyX3LsQf"}],"key":"s9IHFhdrQd"}],"key":"UuVWo7cEto"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LIS-SnowModel (raster) vs. SNODAS (raster)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"INv8iJPUDd"}],"identifier":"lis-snowmodel-raster-vs-snodas-raster","label":"LIS-SnowModel (raster) vs. SNODAS (raster)","html_id":"lis-snowmodel-raster-vs-snodas-raster","implicit":true,"key":"jMTk6qnL5t"}],"key":"vanmAEEY84"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First, we’ll load the SNODAS dataset which we also have hosted on S3 as a Zarr store. This command will take a minute or two to run.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AcsVO2hH78"}],"key":"rZcC0njPQr"}],"key":"X5r5eKLyIa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# load SNODAS dataset\n\n#snodas depth\nkey = \"SNODAS/snodas_snowdepth_20161001_20200930.zarr\"    \nsnodas_depth_ds = xr.open_zarr(s3.get_mapper(f\"{bucket_name}/{key}\"), consolidated=True)\n\n# apply scale factor to convert to meters (0.001 per SNODAS user guide)\nsnodas_depth_ds = snodas_depth_ds * 0.001","key":"VS4LZwfSAc"},{"type":"output","id":"NSu2EWhnnNRswoTVXQsAg","data":[],"key":"eeVCmGEvXM"}],"key":"X3I2rkeFJD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we define a helper function to extract the (lon, lat) of the nearest grid cell to a given point:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uLJRRwE0OW"}],"key":"LyJ4tuyH0M"}],"key":"Lg9JhUAKg1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def nearest_grid(ds, pt):\n    \n    \"\"\"\n    Returns the nearest lon and lat to pt in a given Dataset (ds).\n    \n    pt : input point, tuple (longitude, latitude)\n    output:\n        lon, lat\n    \"\"\"\n    \n    if all(coord in list(ds.coords) for coord in ['lat', 'lon']):\n        df_loc = ds[['lon', 'lat']].to_dataframe().reset_index()\n    else:\n        df_loc = ds[['orig_lon', 'orig_lat']].isel(time=0).to_dataframe().reset_index()\n    \n    loc_valid = df_loc.dropna()\n    pts = loc_valid[['lon', 'lat']].to_numpy()\n    idx = distance.cdist([pt], pts).argmin()\n    \n    return loc_valid['lon'].iloc[idx], loc_valid['lat'].iloc[idx]","key":"yGDxLL8JJ1"},{"type":"output","id":"2Lczo2P8TMARkJl6mz7_F","data":[],"key":"WzSPUf2pV1"}],"key":"airbeJVedT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The next cell will look pretty similar to what we did earlier to plot a timeseries of a single point in the LIS-SnowModel data. The general steps are:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tqnYlTfH54"}],"key":"S2FTL4Y91X"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Extract the coordinates of the SNODAS grid cell nearest to our LIS-SnowModel grid cell (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"heD4mjAL9D"},{"type":"inlineCode","value":"ts_lon","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Tx0HWWSx75"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KBE3ZXxxHU"},{"type":"inlineCode","value":"ts_lat","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tAjR9PskZC"},{"type":"text","value":" from earlier)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pKzhLjlB3F"}],"key":"peDVJyEqeC"}],"key":"HqLriRE8EY"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Subset the SNODAS and LIS-SnowModel data to the grid cells and date ranges of interest","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cTzsDxdQ3v"}],"key":"MVoLgi9KYw"}],"key":"jvcthXvmlf"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create the plots!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xfhYx0fTMX"}],"key":"op0YCnMbke"}],"key":"Zru6i12UQh"}],"key":"zBgY2KsGLB"}],"key":"Hx7ni0oDkp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# drop off irrelevant variables\ndrop_vars = ['orig_lat', 'orig_lon']\nlis_output_ds = lis_output_ds.drop(drop_vars)","key":"HTatOCqdml"},{"type":"output","id":"F1QNovF8SpZEfgNDoVvQp","data":[],"key":"JGc9AoJsFD"}],"key":"vmk2tjWMbC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# get lon, lat of snodas grid cell nearest to the LIS coordinates we used earlier\nsnodas_ts_lon, snodas_ts_lat = nearest_grid(snodas_depth_ds, (ts_lon, ts_lat))\n\n# define a date range to plot (shorter = quicker for demo)\nstart_date, end_date = ('2020-01-01', '2020-06-01')\nplot_daterange = slice(start_date, end_date)\n\n# select SNODAS grid cell and subset to plot_daterange\nsnodas_snd_subset_ds = snodas_depth_ds.sel(lon=snodas_ts_lon,\n                                             lat=snodas_ts_lat,\n                                             time=plot_daterange)\n\n# select LIS grid cell and subset to plot_daterange\nlis_snd_subset_ds = lis_output_ds['SM_SnowDepth_inst'].sel(lat=ts_lat,\n                                                        lon=ts_lon,\n                                                        time=plot_daterange)\n\n# create SNODAS snow depth plot\nsnodas_snd_plot = snodas_snd_subset_ds.hvplot(label='SNODAS')\n\n# create LIS snow depth plot\nlis_snd_plot = lis_snd_subset_ds.hvplot(label='LIS-SnowModel')\n\n# create SNODAS vs LIS snow depth plot\nlis_vs_snodas_snd_plot = (lis_snd_plot * snodas_snd_plot)\n\n# display the plot\nlis_vs_snodas_snd_plot.opts(title=f'Snow Depth @ Lon: {ts_lon}, Lat: {ts_lat}',\n                            legend_position='right',\n                            xlabel='Date',\n                            ylabel='Snow Depth (m)')","key":"g94oWCu2UV"},{"type":"output","id":"9diR-R2isG6jZTR2wLqRN","data":[],"key":"YYeWzy2DTK"}],"key":"tOlYHw1XOB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LIS-SnowModel (raster) vs. SNODAS (raster) vs. SNOTEL (point)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sfuT8nGlTR"}],"identifier":"lis-snowmodel-raster-vs-snodas-raster-vs-snotel-point","label":"LIS-SnowModel (raster) vs. SNODAS (raster) vs. SNOTEL (point)","html_id":"lis-snowmodel-raster-vs-snodas-raster-vs-snotel-point","implicit":true,"key":"wFtJNdCCKW"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now let’s add SNOTEL point data to our plot.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rH6Ke6Qniz"}],"key":"jPa2Zdt8aw"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"First, we’re going to define some helper functions to load the SNOTEL data:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LB5V0V6GFs"}],"key":"dT3rkTPaw7"}],"key":"pBwBX6JWZ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# load csv containing metadata for SNOTEL sites in a given state (e.g,. 'colorado')\ndef load_site(state):\n    \n    # define the path to the file\n    key = f\"SNOTEL/snotel_{state}.csv\"\n    \n    # load the csv into a pandas DataFrame\n    df = pd.read_csv(s3.open(f's3://{bucket_name}/{key}', mode='r'))\n    \n    return df\n\n# load SNOTEL data for a specific site\ndef load_snotel_txt(state, var):\n    \n    # define the path to the file\n    key = f\"SNOTEL/snotel_{state}{var}_20162020.txt\"\n    \n    # determine how many lines to skip in the file (they start with #)\n    fh = s3.open(f\"{bucket_name}/{key}\")\n    lines = fh.readlines()\n    skips = sum(1 for ln in lines if ln.decode('ascii').startswith('#'))\n    \n    # load the data into a pandas DataFrame\n    df = pd.read_csv(s3.open(f\"s3://{bucket_name}/{key}\"), skiprows=skips)\n    \n    # convert the Date column from strings to datetime objects\n    df['Date'] = pd.to_datetime(df['Date'])\n    return df","key":"Y7QXLyxhUw"},{"type":"output","id":"0lSs2WJII623GDUH7EW__","data":[],"key":"itTPEOBsYx"}],"key":"jydGidgep8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For the purposes of this tutorial let’s load the SNOTEL data for sites in Colorado. We’ll pick one site to plot in a few cells.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XNOBxPJdop"}],"key":"BFOhXiiRMh"}],"key":"FqPYibXnsv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# load SNOTEL snow depth for Colorado into a dictionary\nsnotel_depth = {'CO': load_snotel_txt('CO', 'depth')}","key":"Fop2IMj7yZ"},{"type":"output","id":"KVZaONUZxqydOJmZmgIof","data":[],"key":"aSDwGmAkBK"}],"key":"YVgIk7z74f"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’ll need another helper function to load the depth data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aCtcXyhnvK"}],"key":"GKwTBHueHf"}],"key":"yOngdaripy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# get snotel depth\ndef get_depth(state, site, start_date, end_date):\n    \n    # grab the depth for the given state (e.g., CO)\n    df = snotel_depth[state]\n    \n    # define a date range mask\n    mask = (df['Date'] \u003e= start_date) \u0026 (df['Date'] \u003c= end_date)\n    \n    # use mask to subset between time range\n    df = df.loc[mask]\n    \n    # extract timeseries for the given site\n    return pd.concat([df.Date, df.filter(like=site)], axis=1).set_index('Date')","key":"KKUyKtbBQu"},{"type":"output","id":"iPrC985G3RXOFTiY2X-m2","data":[],"key":"XQ4uJbT4n4"}],"key":"rZEgq6DgfC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the site metadata for Colorado:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xupYdyjeTC"}],"key":"egukNa2hYp"}],"key":"Gqpv3BSUYm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"co_sites = load_site('colorado')\n\n# peek at the first 5 rows\nco_sites.head()","key":"tupLUJa6hq"},{"type":"output","id":"2JUHUxgOOSAZ-Mh1nU6S2","data":[],"key":"DiVxNMbgtA"}],"key":"UzlQwHZNPy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The point we’ve been using so far in the tutorial actually corresponds to the coordinates for the Park Reservoir SNOTEL on Grand Mesa! Let’s extract the site data for that point:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IGZmk5Ujsy"}],"key":"SRwBhIfIYP"}],"key":"m2vtWluu38"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# get the depth data by passing the site name to the get_depth() function\npark_res_snd_df = get_depth('CO', 'Park Reservoir (682)', start_date, end_date)\n\n# convert from cm to m\npark_res_snd_df = park_res_snd_df / 100","key":"U5fzxDbuSF"},{"type":"output","id":"ZrlGxww2kzF433QWlpPr7","data":[],"key":"kHN7fmp4NC"}],"key":"DIKfWrXqDj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we’re ready to plot:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"up978fCBmA"}],"key":"RxGfGVtqWW"}],"key":"pg6BjiOGiz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# create SNOTEL plot\npark_res_plot = park_res_snd_df.hvplot(label='SNOTEL')\n\n# combine the SNOTEl plot with the LIS vs SNODAS plot\n(lis_vs_snodas_snd_plot * park_res_plot).opts(title=f'Snow Depth @ Lon: {ts_lon}, Lat: {ts_lat}', legend_position='right')","key":"ANwOlWAxLz"},{"type":"output","id":"x5vPLS2j6wemnWqvONihP","data":[],"key":"UI9SMEpcjp"}],"key":"iwRVlPpgNK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interactive Data Exploration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kT6dd6GTa1"}],"identifier":"interactive-data-exploration","label":"Interactive Data Exploration","html_id":"interactive-data-exploration","implicit":true,"key":"wyYoM7Fli8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Note:You must run the following code in JupyterLab for interactivity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mfGiZxrabh"}],"key":"FNThQ7mpQU"}],"key":"cWgAWmGNqT"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We’ve now built up the separate pieces for visualizing LIS-SnowModel output spatially and temporally, and we’ve combined our time series with those from SNOTEL stations and SNODAS. Now we can bring it all together in an interactive tool.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JeKdh2amHs"}],"key":"mAJSMGDitr"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The code in the cells below will generate an interactive panel for comparing of LIS-SnowModel output, SNODAS, and SNOTEL snow depth and snow water equivalent at SNOTEL site locations.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"E0O8B9f4wu"}],"key":"mxeVAyYk5R"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Note: some cells below take several minutes to run and some aspects of the interactive widgets may not work in the rendered version on the Hackweek site.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BYFWxLCPpp"}],"key":"lrOnSdll4Z"}],"key":"agFnvfrR3u"}],"key":"nkzNdAZtVs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YeCZIxGD8v"}],"identifier":"load-data","label":"Load Data","html_id":"load-data","implicit":true,"key":"RHBl1Pzsub"}],"key":"Gkk45ZGanc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SNOTEL Sites info","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GnwLA19zol"}],"identifier":"snotel-sites-info","label":"SNOTEL Sites info","html_id":"snotel-sites-info","implicit":true,"key":"C8n39g3iNJ"}],"key":"CiczRLnDu3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# create dictionary linking state names and abbreviations\nsnotel = {\"CO\" : \"colorado\",\n          \"ID\" : \"idaho\",\n          \"NM\" : \"newmexico\",\n          \"UT\" : \"utah\",\n          \"WY\" : \"wyoming\"}","key":"ciq8mvB0vR"},{"type":"output","id":"a1slbZ1fpShacUvBDXs9l","data":[],"key":"b2fr6K6UPb"}],"key":"FcOpwBkBdX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# load SNOTEL site metadata for sites in the given state\ndef load_site(state):\n    \n    # define path to file\n    key = f\"SNOTEL/snotel_{state}.csv\"\n    \n    # load csv into pandas DataFrame\n    df = pd.read_csv(s3.open(f'{bucket_name}/{key}', mode='r'))\n    \n    return df ","key":"YOeOQoRBwg"},{"type":"output","id":"rWIBjuBy7ASVQXeypxT3B","data":[],"key":"JtaZPkOhQD"}],"key":"HjwivbdJDX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SNOTEL Depth \u0026 SWE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sEdH9PQyfc"}],"identifier":"snotel-depth-swe","label":"SNOTEL Depth \u0026 SWE","html_id":"snotel-depth-swe","implicit":true,"key":"BR8pDV5OdP"}],"key":"INk9cPgyHV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def load_snotel_txt(state, var):\n    \n    # define path to file\n    key = f\"SNOTEL/snotel_{state}{var}_20162020.txt\"\n\n    # open text file\n    fh = s3.open(f\"{bucket_name}/{key}\")\n    \n    # read each line and note those that begin with '#'\n    lines = fh.readlines()\n    skips = sum(1 for ln in lines if ln.decode('ascii').startswith('#'))\n    \n    # load txt file into pandas DataFrame (skipping lines beginning with '#')\n    df = pd.read_csv(s3.open(f\"{bucket_name}/{key}\"), skiprows=skips)\n    \n    # convert Date column from str to pandas datetime objects\n    df['Date'] = pd.to_datetime(df['Date'])\n    return df","key":"u72948hIfA"},{"type":"output","id":"s833LrOLYmHMQPldysUOC","data":[],"key":"jW1BB2zbSr"}],"key":"DXW0Tp3iDu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# load SNOTEL depth \u0026 swe into dictionaries\n\n# define empty dicts\nsnotel_depth = {}\nsnotel_swe = {}\n\n# loop over states and load SNOTEL data\nfor state in snotel.keys():\n    print(f\"Loading state {state}\")\n    snotel_depth[state] = load_snotel_txt(state, 'depth')\n    snotel_swe[state] = load_snotel_txt(state, 'swe')","key":"lyHXMgaE9f"},{"type":"output","id":"JyOAgtcoO0g53vqNBfP_r","data":[],"key":"WOOFaBQ9p5"}],"key":"aB13zDCk1B"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"SNODAS SWE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ro8TKbJS2d"}],"identifier":"snodas-swe","label":"SNODAS SWE","html_id":"snodas-swe","implicit":true,"key":"w2VwO0i2qj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’ve already loaded in SNODAS snow depths, but here we’ll load in SWE. As above, this cell might take a few minutes to run since it’s a large dataset to read.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mEcKSHXF9h"}],"key":"CrbL4rdvtS"}],"key":"I4BZE5o1gX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# load snodas swe data\nkey = \"SNODAS/snodas_swe_20161001_20200930.zarr\"\nsnodas_swe_ds = xr.open_zarr(s3.get_mapper(f\"{bucket_name}/{key}\"), consolidated=True)","key":"r1ovJQoiFI"},{"type":"output","id":"tB_mxIIbj4pdw2oVPSfhH","data":[],"key":"TVqENngHfx"}],"key":"BZiepLdOL5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LIS-SnowModel Outputs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OE5BV3fME6"}],"identifier":"lis-snowmodel-outputs","label":"LIS-SnowModel Outputs","html_id":"lis-snowmodel-outputs","implicit":true,"key":"I28we2lMsi"}],"key":"M1gq8SdIyE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’ve already read in the LIS-SnowModel data above. Here we subset by time for October 2019 - June 2020.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v3EizNdpwA"}],"key":"B1LKTvpcqA"}],"key":"K5cA5jD6TC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# subset LIS data for winter 2020 \ntime_range = slice('2019-10-01', '2020-06-30')\nlis_sf = lis_output_ds_tc.sel(time=time_range)\nlis_sf = lis_sf.drop(drop_vars)","key":"ZKCmaIg3Mj"},{"type":"output","id":"EpS3InSyObKW3GnmqKrC7","data":[],"key":"jSqQx7GE8y"}],"key":"z2n0DpC04n"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the next cell, we extract the data variable names and timesteps from the LIS outputs. These will be used to define the widget options.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A5YzTub9bs"}],"key":"j2n34eb1VK"}],"key":"Upql5GTvYq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# gather metadata from LIS\n# get variable names:string\nvnames = list(lis_sf.data_vars)\nprint(vnames)\n\n# get time-stamps:string\ntstamps = list(np.datetime_as_string(lis_sf.time.values, 'D'))\nprint(len(tstamps), tstamps[0], tstamps[-1])","key":"dSAQrwH79b"},{"type":"output","id":"e_XSLsYBgksWGm3zmsSC0","data":[],"key":"plpdgyvpRE"}],"key":"xzeWquvUrf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By default, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O9JGaSsyyR"},{"type":"inlineCode","value":"holoviews","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z4r94tJBeQ"},{"type":"text","value":" plotting library automatically adjusts the range of plot colorbars based on the range of values in the data being plotted. This may not be ideal when comparing data on different timesteps. In the next cell we assign the upper and lower bounds for each data variable which we’ll later use to set a static colorbar range.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vt9hcP1aid"}],"key":"br8UG7cJGX"}],"key":"WaqtbwVMxE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmap_lims = {'SM_SWE_inst': (0.0, 3.0),\n 'SM_SnowDensity_inst': (100, 550.0),\n 'SM_SnowDepth_inst': (0.0, 6.5)}","key":"JyYOHeDNQo"},{"type":"output","id":"WRR5KHSuELipPLBXz3FkN","data":[],"key":"awNjVh3qAM"}],"key":"hExnJ7yTyd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interactive Widget","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kYdmGqPfNI"}],"identifier":"interactive-widget","label":"Interactive Widget","html_id":"interactive-widget","implicit":true,"key":"xfX09bDJFf"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"SNOTEL Site Map and Timeseries","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"I0T6cFLW6a"}],"identifier":"snotel-site-map-and-timeseries","label":"SNOTEL Site Map and Timeseries","html_id":"snotel-site-map-and-timeseries","implicit":true,"key":"NKS9Mfuxl2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The two cells that follow will create an interactive panel for comparing LIS-SnowModel, SNODAS, and SNOTEL snow depth and snow water equivalent. The SNOTEL site locations are plotted as points on an interactive map for each state. Hover over the sites to view metadata and click on a site to generate a timeseries!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jGq9UHiTAM"}],"key":"NUog55XNCg"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Note: it will take some time for the timeseries to display.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LIkkuC5MGq"}],"key":"VqsyXBwQmr"}],"key":"hYRdTs1PAl"}],"key":"tqRZOalJlr"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# get snotel depth\ndef get_depth(state, site, ts, te):\n    df = snotel_depth[state]\n    \n    # subset between time range\n    mask = (df['Date'] \u003e= ts) \u0026 (df['Date'] \u003c= te)\n    df = df.loc[mask]\n    \n    # extract timeseries for the site\n    return pd.concat([df.Date, df.filter(like=site)], axis=1).set_index('Date')\n\n# get snotel swe\ndef get_swe(state, site, ts, te):\n    df = snotel_swe[state]\n    \n    # subset between time range\n    mask = (df['Date'] \u003e= ts) \u0026 (df['Date'] \u003c= te)\n    df = df.loc[mask]\n    \n    # extract timeseries for the site\n    return pd.concat([df.Date, df.filter(like=site)], axis=1).set_index('Date')\n\n# co-locate site \u0026 LIS-SnowModel model cell\ndef nearest_grid(pt):\n    # pt : input point, tuple (longtitude, latitude)\n    # output:\n    #        x_idx, y_idx \n    loc_valid = df_loc.dropna()\n    pts = loc_valid[['lon', 'lat']].to_numpy()\n    idx = distance.cdist([pt], pts).argmin()\n\n    return loc_valid['east_west'].iloc[idx], loc_valid['north_south'].iloc[idx]\n\n# get LIS-SnowModel variable \ndef var_subset(dset, v, lon, lat, ts, te):\n    return dset[v].sel(lon=lon, lat=lat, method=\"nearest\").sel(time=slice(ts, te)).load()\n\n# line plots\ndef line_callback(index, state, vname, ts_tag, te_tag):\n    sites = load_site(snotel[state])\n    row = sites.iloc[1]\n    \n    tmp = var_subset(lis_sf, vname, row.lon, row.lat, ts_tag, te_tag) \n    xr_sf = xr.zeros_like(tmp)\n    \n    xr_snodas = xr_sf\n    \n    ck = get_depth(state, row.site_name, ts_tag, te_tag).to_xarray().rename({'Date': 'time'})\n    xr_snotel = xr.zeros_like(ck)\n    \n    if not index:\n        title='Var: -- Lon: -- Lat: --'\n        return (xr_sf.hvplot(title=title, color='blue', label='LIS-SnowModel') \\\n                * xr_snotel.hvplot(color='red', label='SNOTEL') \\\n                * xr_snodas.hvplot(color='green', label='SNODAS')).opts(legend_position='right')\n        \n\n    else:\n        sites = load_site(snotel[state])\n        first_index = index[0]\n        row = sites.iloc[first_index]\n    \n        \n        xr_sf = var_subset(lis_sf, vname, row.lon, row.lat, ts_tag, te_tag)\n    \n        vs = vname.split('_')[1]\n        title=f'Var: {vs} Lon: {row.lon} Lat: {row.lat}'\n\n        \n        # update snotel data \n        if 'depth' in vname.lower():\n            xr_snotel =  get_depth(state, row.site_name, ts_tag, te_tag).to_xarray().rename({'Date': 'time'})*0.01\n            xr_snodas =  var_subset(snodas_depth_ds, 'SNOWDEPTH', row.lon, row.lat, ts_tag, te_tag)\n        \n        if 'swe' in vname.lower():\n            xr_snotel =  get_swe(state, row.site_name, ts_tag, te_tag).to_xarray().rename({'Date': 'time'})/1000\n            xr_snodas =  var_subset(snodas_swe_ds, 'SWE', row.lon, row.lat, ts_tag, te_tag)/1000\n\n    \n        return xr_sf.hvplot(title=title, color='blue', label='LIS-SnowModel') \\\n               * xr_snotel.hvplot(color='red', label='SNOTEL') \\\n               * xr_snodas.hvplot(color='green', label='SNODAS')\n\n","visibility":"show","key":"Ob4FubIVGC"},{"type":"output","id":"SruFSpbeb5Zi5wXeNoNe0","data":[],"visibility":"show","key":"SFXUF248H3"}],"visibility":"show","key":"Wy1mDTeKoQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# satic snowdepth as background\ndds = lis_sf['SM_SnowDepth_inst'].sel(time='2020-02-01').load()","key":"rD84QwwENR"},{"type":"output","id":"6cl_ywZx0RbtWkuUscgRS","data":[],"key":"YHMsdXCfCn"}],"key":"S2ozwLhsiV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# prepare the panel that will display a static plot of snow depth. Snotel sites will be plotted on top\nimg = dds.hvplot.quadmesh(geo=True, rasterize=True, project=True,\n                             xlabel='lon', ylabel='lat', cmap='viridis',\n                             clim=(0,1))\nsnow_depth_bg=hd.regrid(img)","key":"BHCVX25DXc"},{"type":"output","id":"otUmPAU9liK725Gjz-2Ii","data":[],"key":"IuIMGigUbb"}],"key":"vzBYuFjanv"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# sites on map\ndef plot_points(state):  \n    # dataframe to hvplot obj Points\n    sites=load_site(snotel[state])\n    pts_opts=dict(size=10, nonselection_alpha=0.5,tools=['tap', 'hover'])\n    #site_points=sites.hvplot.points(x='lon', y='lat', c='elev', cmap='fire', geo=True, hover_cols=['site_name', 'ntwk', 'state', 'lon', 'lat']).opts(**pts_opts)  \n    site_points=sites.hvplot.points(x='lon', y='lat', color='black',geo=True, hover_cols=['site_name', 'ntwk', 'state', 'lon', 'lat']).opts(**pts_opts)  \n    return site_points\n\n# base map\ntiles = gvts.OSM()\n\n# state widget\nstate_select = pn.widgets.Select(options=list(snotel.keys()), name=\"State\")\nstate_stream = Params(state_select, ['value'], rename={'value':'state'})\n\n# variable widget\nvar_select = pn.widgets.Select(options=['SM_SnowDepth_inst', 'SM_SWE_inst'], name=\"LIS Variable List\")\nvar_stream = Params(var_select, ['value'], rename={'value':'vname'})\n\n# date range widget\ndate_fmt = '%Y-%m-%d'\nsdate_input = pn.widgets.DatetimeInput(name='Start date', value=dt(2019,10,1),start=dt.strptime(tstamps[0], date_fmt), end=dt.strptime(tstamps[-1], date_fmt), format=date_fmt)\nsdate_stream = Params(sdate_input, ['value'], rename={'value':'ts_tag'})\nedate_input = pn.widgets.DatetimeInput(name='End date', value=dt(2020,6,30),start=dt.strptime(tstamps[0], date_fmt), end=dt.strptime(tstamps[-1], date_fmt),format=date_fmt)\nedate_stream = Params(edate_input, ['value'], rename={'value':'te_tag'})\n\n# generate site points as dynamic map\n# plots points and calls plot_points() when user selects a site\nsite_dmap = hv.DynamicMap(plot_points, streams=[state_stream]).opts(height=400, width=600)\n# pick site\nselect_stream = Selection1D(source=site_dmap)\n\n# link widgets to callback function\nline = hv.DynamicMap(line_callback, streams=[select_stream, state_stream, var_stream, sdate_stream, edate_stream])\n\n# create panel layout\npn.Row(snow_depth_bg*site_dmap*tiles, pn.Column(state_select, var_select, pn.Row(sdate_input, edate_input), line))","visibility":"show","key":"HzANr6LgSg"},{"type":"output","id":"pWL2mJ3VBaESkdy4iApp1","data":[],"visibility":"show","key":"U2hoSTCjpJ"}],"visibility":"show","key":"RR3b54yAOD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercises","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jt4IrVyxio"}],"identifier":"exercises","label":"Exercises","html_id":"exercises","implicit":true,"key":"mO16FFYKmv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You now know how to see what variables are available in a typical model output file and you’ve learned how to inspect gridded model estimates both spatially and temporally. Below are a few exercises for both practicing the above skills and for becoming more familiar with the sample model output.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NjYFd8Zjjz"}],"key":"mFY567Vmpe"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Exercise 1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iJueNqIRM1"}],"identifier":"exercise-1","label":"Exercise 1","html_id":"exercise-1","implicit":true,"key":"n5ZaQiLtqG"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"So far we’ve mostly worked with the Grand Mesa region. Can you spatially subset the data to inspect the LIS-SnowModel estimates for the Front Range? What about for Senator Beck basin? Try to use hvplot to plot a map of SWE values for February 2020.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"OS1Jl8dyBB"}],"key":"reYhBeEe8m"},{"type":"heading","depth":3,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Exercise 2","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"N5Fk8K2Zbx"}],"identifier":"exercise-2","label":"Exercise 2","html_id":"exercise-2","implicit":true,"key":"Fy1cLASrPl"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Here we focused on water year 2020. Can you select a point (maybe the same Park Reservoir SNOTEL point we worked with here) and make a multi-year time series?","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Ni7o3q3avZ"}],"key":"VA0xxHPW3V"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Exercise 3 (for an extra challenge!)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NhOfJUcUA7"}],"identifier":"exercise-3-for-an-extra-challenge","label":"Exercise 3 (for an extra challenge!)","html_id":"exercise-3-for-an-extra-challenge","implicit":true,"key":"rrcPoQvkiN"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"We learned about the SnowEx database in a tutorial earlier this week. Can you create a new notebook for combining the model output with your choice of field observation available in the database? Does the model over or underestimate the SnowEx observation?","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"MVlSQPh6Au"}],"key":"lMT744jOK1"}],"key":"bUv4cOzIKi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Conclusion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dagx9Ax2AM"}],"identifier":"conclusion","label":"Conclusion","html_id":"conclusion","implicit":true,"key":"ov3QV9g8NI"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’re now more familiar with model output and how to interact with it in Python. The code in this notebook is a great jumping off point for developing more advanced comparisons and interactive widgets.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dh0FdhTkbY"}],"key":"OmOvNABwSY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The Python code can be adapted to other LIS simulations and to other model output as well, with minor modifications. Anyone interested in testing your new skills can combine what you learned here with the other SnowEx Hackweek tutorials - try comparing the LIS-SnowModel output with other snow observations collected during the 2017 field campaign!","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B9wtYXboS2"}],"key":"wyYOcX30Js"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"For more information on ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zJpk0aNplD"},{"type":"link","url":"https://lis.gsfc.nasa.gov/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"NASA’s Land Information System","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"O0whdynkko"}],"urlSource":"https://lis.gsfc.nasa.gov/","key":"pwUcRidNr6"},{"type":"text","value":" please see the links below","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"L9GC7l5UmS"}],"key":"pUQTAd7icF"}],"key":"CrKIoxDh3s"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DIt53PUKUE"}],"identifier":"resources","label":"Resources","html_id":"resources","implicit":true,"key":"heEXigOi0Y"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Links","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HS6xycr3Wd"}],"key":"MuRomHx5Bc"}],"key":"jn53ND5IPo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://lis.gsfc.nasa.gov/","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"LIS Website","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EUgGCpALqT"}],"urlSource":"https://lis.gsfc.nasa.gov/","key":"ESttv1ir8F"}],"key":"GHRQWzpgXi"}],"key":"ibaejvUQP8"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/NASA-LIS/LISF","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"LIS on GitHub","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"uQXmdh3zcj"}],"urlSource":"https://github.com/NASA-LIS/LISF","error":true,"key":"Sf1w51u1op"}],"key":"xbuWa8S5NQ"}],"key":"K7VaHoaPuM"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/NASA-LIS/LISF/blob/master/docs/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"LIS Documentation","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nG8BOsPmfi"}],"urlSource":"https://github.com/NASA-LIS/LISF/blob/master/docs/","data":{"kind":"file","org":"NASA-LIS","repo":"LISF","reference":"master","file":"docs/","raw":"https://raw.githubusercontent.com/NASA-LIS/LISF/master/docs/"},"internal":false,"protocol":"github","key":"EWuhY6sqOj"}],"key":"Jot3zwW36J"}],"key":"BbzFKFqlCW"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://github.com/bmcandr/lis-public-tc-walkthrough","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"LIS Test Case Walkthrough","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xNRLWxLoZs"}],"urlSource":"https://github.com/bmcandr/lis-public-tc-walkthrough","error":true,"key":"bzAb5V0aLW"}],"key":"v9J0vpxfLt"}],"key":"DcWVoH07rr"}],"key":"xqp4HUBHFz"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"References","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"bsAoZW1dbB"}],"key":"MUMnZZb8bd"}],"key":"M1DMubGvRS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Kumar, S.V., C.D. Peters-Lidard, Y. Tian, P.R. Houser, J. Geiger, S. Olden, L. Lighty, J.L. Eastman, B. Doty, P. Dirmeyer, J. Adams, K. Mitchell, E. F. Wood, and J. Sheffield, 2006: Land Information System - An interoperable framework for high resolution land surface modeling. Environ. Modeling \u0026 Software, 21, 1402-1415, ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"r7i9Ug3fNp"},{"type":"cite","url":"https://doi.org/10.1016/j.envsoft.2005.07.004","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"KUMAR ","key":"xAjXAcNZzI"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"qJj4WzpLoK"}],"key":"qYr92pYKqk"},{"type":"text","value":" (2006)","key":"WK5xA4snnF"}],"kind":"narrative","label":"KUMAR_2006","identifier":"https://doi.org/10.1016/j.envsoft.2005.07.004","enumerator":"2","key":"W5gQmC0knY"}],"key":"Yos7IirpQA"}],"key":"m0i7wcjsso"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Peters-Lidard, C.D., P.R. Houser, Y. Tian, S.V. Kumar, J. Geiger, S. Olden, L. Lighty, B. Doty, P. Dirmeyer, J. Adams, K. Mitchell, E.F. Wood, and J. Sheffield, 2007: High-performance Earth system modeling with NASA/GSFC’s Land Information System. Innovations in Systems and Software Engineering, 3(3), 157-165, ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"bOowRA46Bf"},{"type":"cite","url":"https://doi.org/10.1007/s11334-007-0028-x","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Peters-Lidard ","key":"cefL4DHCXb"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"g2DaRtqot1"}],"key":"vwc3ALewac"},{"type":"text","value":" (2007)","key":"zrcE7v0u7C"}],"kind":"narrative","label":"Peters_Lidard_2007","identifier":"https://doi.org/10.1007/s11334-007-0028-x","enumerator":"3","key":"HvsCY91iRu"}],"key":"bLn3fRlGoi"}],"key":"g2mOLeHFA0"}],"key":"M7idub6UBl"},{"type":"code","lang":"","value":"","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RrcN3fBzlH"}],"key":"WDfFkn1xTe"}],"key":"qvscATM37I"},"references":{"cite":{"order":["Liston_2006","KUMAR_2006","Peters_Lidard_2007"],"data":{"Liston_2006":{"label":"Liston_2006","enumerator":"1","doi":"10.1175/jhm548.1","html":"Liston, G. E., \u0026 Elder, K. (2006). A Distributed Snow-Evolution Modeling System (SnowModel). \u003ci\u003eJournal of Hydrometeorology\u003c/i\u003e, \u003ci\u003e7\u003c/i\u003e(6), 1259–1276. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/jhm548.1\"\u003e10.1175/jhm548.1\u003c/a\u003e","url":"https://doi.org/10.1175/jhm548.1"},"KUMAR_2006":{"label":"KUMAR_2006","enumerator":"2","doi":"10.1016/j.envsoft.2005.07.004","html":"KUMAR, S., PETERSLIDARD, C., TIAN, Y., HOUSER, P., GEIGER, J., OLDEN, S., LIGHTY, L., EASTMAN, J., DOTY, B., \u0026 DIRMEYER, P. (2006). Land information system: An interoperable framework for high resolution land surface modeling. \u003ci\u003eEnvironmental Modelling \u0026amp; Software\u003c/i\u003e, \u003ci\u003e21\u003c/i\u003e(10), 1402–1415. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1016/j.envsoft.2005.07.004\"\u003e10.1016/j.envsoft.2005.07.004\u003c/a\u003e","url":"https://doi.org/10.1016/j.envsoft.2005.07.004"},"Peters_Lidard_2007":{"label":"Peters_Lidard_2007","enumerator":"3","doi":"10.1007/s11334-007-0028-x","html":"Peters-Lidard, C. D., Houser, P. R., Tian, Y., Kumar, S. V., Geiger, J., Olden, S., Lighty, L., Doty, B., Dirmeyer, P., Adams, J., Mitchell, K., Wood, E. F., \u0026 Sheffield, J. (2007). High-performance Earth system modeling with NASA/GSFC’s Land Information System. \u003ci\u003eInnovations in Systems and Software Engineering\u003c/i\u003e, \u003ci\u003e3\u003c/i\u003e(3), 157–165. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1007/s11334-007-0028-x\"\u003e10.1007/s11334-007-0028-x\u003c/a\u003e","url":"https://doi.org/10.1007/s11334-007-0028-x"}}}},"footer":{"navigation":{"prev":{"title":"Neural Networks with PyTorch","url":"/notebooks/pytorch-tutorial","group":"Analysis and Machine Learning"},"next":{"title":"Reanalysis Data Access","url":"/notebooks/ucla-data-access","group":"Analysis and Machine Learning"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Snow Cookbook","authors":[{"nameParsed":{"literal":"The SnowPit Community","given":"The SnowPit","family":"Community"},"name":"The SnowPit Community","id":"contributors-myst-generated-uid-0"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/SnowEx/snow-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"children":[{"file":"notebooks/snowex_data_overview.ipynb"},{"file":"notebooks/earthaccess_snowex.ipynb"},{"file":"notebooks/snowex_database.ipynb"}],"title":"Data Access"},{"children":[{"file":"notebooks/GPR_Lidar_HackweekTutorial.ipynb"},{"file":"notebooks/thermal-ir-tutorial-pt1.ipynb"},{"file":"notebooks/timelapse-camera-tutorial.ipynb"},{"file":"notebooks/uavsar_accessing_imagery_pt1.ipynb"},{"file":"notebooks/microstructure-tutorial.ipynb"},{"file":"notebooks/aviris-ng-data.ipynb"},{"file":"notebooks/tls_data_access.ipynb"},{"file":"notebooks/is2_snow_depth_workflow.ipynb"},{"file":"notebooks/snotel_data_access.ipynb"},{"file":"notebooks/snow-pit_data_access.ipynb"}],"title":"Observations"},{"children":[{"file":"notebooks/pytorch_tutorial.ipynb"},{"file":"notebooks/snowmodeling_tutorial_pt1.ipynb"},{"file":"notebooks/UCLA_data_access.ipynb"},{"file":"notebooks/merra2_data_access.ipynb"},{"file":"notebooks/era5_data_access.ipynb"}],"title":"Analysis and Machine Learning"}],"thumbnail":"/snow-cookbook/_preview/28/build/3a5b2698b5d21d107a57901ba13beff9.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Data Access"},{"slug":"notebooks.snowex-data-overview","title":"Field Campaigns Overview","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/01_banner-d9b3e57eb42070adace4f392118daba6.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snowex-database","title":"SnowExSQL Database","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/data_examples-c054d6cf607965e4ac0a89d3db9802bd.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Observations"},{"slug":"notebooks.gpr-lidar-hackweektutorial","title":"GPR and Lidar","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/HackweekGraphicalAbs-bb405b95695bbee28952e1f4b4e49291.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.timelapse-camera-tutorial","title":"Time-lapse Cameras","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/timelapse-camera-tut-b5bfa4932edd6cc12e4e2967e9236138.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.uavsar-accessing-imagery-pt1","title":"UAVSAR","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/sthelens-3c4772d95993048f6f301a5d5bc55f96.jpeg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.microstructure-tutorial","title":"Microstructure","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/dozier2009_fig2-df1e2c8b238833f3221eb53163d3ca2d.jpg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.aviris-ng-data","title":"AVIRIS-NG","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/2f77469a46f5527021926e2a430aabc5.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.tls-data-access","title":"Terrestrial Laser Scanning","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.is2-snow-depth-workflow","title":"Snow Depth Estimates with ICESat-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snotel-data-access","title":"SNOTEL Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snow-pit-data-access","title":"Snow Pit Data Access and SWE Calculation","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Analysis and Machine Learning"},{"slug":"notebooks.pytorch-tutorial","title":"Neural Networks with PyTorch","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.snowmodeling-tutorial-pt1","title":"Snow Modeling","description":"","date":"","thumbnail":"/snow-cookbook/_preview/28/build/DAflowchart_v4-4b99dfbf43b6e511557fad8872c02208.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.ucla-data-access","title":"Reanalysis Data Access","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.merra2-data-access","title":"MERRA-2","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.era5-data-access","title":"ERA5","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/snow-cookbook/_preview/28/build/manifest-ED236704.js";
import * as route0 from "/snow-cookbook/_preview/28/build/root-ZJOPFBMV.js";
import * as route1 from "/snow-cookbook/_preview/28/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/snow-cookbook/_preview/28/build/entry.client-UNPC4GT3.js");</script></body></html>